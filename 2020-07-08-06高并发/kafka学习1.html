<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Kafka学习(一) | 悟空</title>
  <meta name="keywords" content=" kafka ">
  <meta name="description" content="Kafka学习(一) | 悟空">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta property="og:type" content="website">
<meta property="og:title" content="悟空">
<meta property="og:url" content="http://yoursite.com/404.html">
<meta property="og:site_name" content="悟空">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-11-16T00:43:02.436Z">
<meta property="article:modified_time" content="2019-11-08T14:02:36.972Z">
<meta property="article:author" content="悟空">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/darcula.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.css"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/aplayer/1.10.1/APlayer.min.js"></script>
<script src="https://unpkg.com/meting@1.2/dist/Meting.min.js"></script>
<meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="悟空" type="application/atom+xml">
</head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/" class="avatar_target">
    <img class="avatar" src="/img/avatar.jpg" />
</a>
<div class="author">
    <span>悟空</span>
</div>

<div class="icon">
    
        
        <a title="rss" href="/atom.xml" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-rss"></use>
                </svg>
            
        </a>
        
    
        
        <a title="github" href="https://github.com/Monkey-kong" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-github"></use>
                </svg>
            
        </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a title="zhihu" href="https://www.zhihu.com/people/wukong-16" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-zhihu"></use>
                </svg>
            
        </a>
        
    
        
    
        
    
        
    
        
        <a title="email" href="mailto:lixianfu1@outlook.com" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-email"></use>
                </svg>
            
        </a>
        
    
        
        <a title="qq" href="http://wpa.qq.com/msgrd?v=3&uin=1109075867&site=qq&menu=yes" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-qq"></use>
                </svg>
            
        </a>
        
    
        
    
        
    
</div>




<ul>
    <li><div class="all active" data-rel="全部文章">全部文章<small>(140)</small></div></li>
    
        
            
            <li><div data-rel="Java基础">Java基础<small>(18)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="JVM">JVM<small>(11)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="多线程">多线程<small>(7)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="OS">OS<small>(5)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="IO">IO<small>(9)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="高并发">高并发<small>(12)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="MySQL">MySQL<small>(16)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="分布式">分布式<small>(26)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="设计模式">设计模式<small>(4)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="算法">算法<small>(6)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="前端">前端<small>(7)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="其他">其他<small>(10)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="kafka">kafka<small>(3)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="Spring基础">Spring基础<small>(5)</small></div>
                
            </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
    
    
    
    
    </div>
    <div><a class="about  hasFriend  site_url"  href="/about">关于</a><a style="width: 50%"  class="friends">友链</a></div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="140">
<input type="hidden" id="yelog_site_word_count" value="398k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="http://yelog.org/">叶落阁</a></li>
            
            <li><a target="_blank" href="https://www.chenuon.cn/">程忧点滴</a></li>
            
            <li><a target="_blank" href="https://blog.jamespan.me/">小鶸の道场</a></li>
            
            <li><a target="_blank" href="http://www.ruanyifeng.com/home.html">阮一峰</a></li>
            
            <li><a target="_blank" href="https://www.haomwei.com/">屠城</a></li>
            
            <li><a target="_blank" href="https://hasaik.com/">hasaik</a></li>
            
            <li><a target="_blank" href="https://www.imalan.cn/">三无计划</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">全部文章</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" />
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>博客</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>多线程</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>分布式会话</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>分布式配置</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>分布式任务</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>架构</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>内网穿透</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>其他</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>算法</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>随笔</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>网络</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>远程连接</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Blog</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Dubbo</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Eureka</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>flex</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>frp</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Git</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>https</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>IO</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Java讲义</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>JVM</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>kafka</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Linux</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>LVS</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>MySQL</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Nginx</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>NIO</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Observer</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>OS</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Proxy</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Redis</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>RSC</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>sia</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Singleton</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Spring Cloud</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>TypeScript</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>uni-app</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>vue</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>webpack</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ZooKeeper</a>
            </li>
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        <a  class="全部文章 "
           href="/2021-05-11-07MySQL/mycat_4_%E4%B8%80%E8%87%B4%E6%80%A7hash%E7%90%86%E8%A7%A3.html"
           data-tag=""
           data-author="" >
            <span class="post-title" title=""></span>
            <span class="post-date" title="2021-05-11 23:44:02">2021/05/11</span>
        </a>
        
        <a  class="全部文章 kafka "
           href="/2021-05-04-06%E9%AB%98%E5%B9%B6%E5%8F%91/kafka%E5%AD%A6%E4%B9%A03.html"
           data-tag="kafka"
           data-author="" >
            <span class="post-title" title="Kafka学习(三)">Kafka学习(三)</span>
            <span class="post-date" title="2021-05-04 22:13:12">2021/05/04</span>
        </a>
        
        <a  class="全部文章 MySQL "
           href="/2021-05-04-07MySQL/mycat_1.html"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="Mycat">Mycat</span>
            <span class="post-date" title="2021-05-04 22:13:12">2021/05/04</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2021-05-01-08%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86-disconf.html"
           data-tag="分布式配置"
           data-author="" >
            <span class="post-title" title="分布式配置管理(一)">分布式配置管理(一)</span>
            <span class="post-date" title="2021-05-01 20:43:12">2021/05/01</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2021-01-18-08%E5%88%86%E5%B8%83%E5%BC%8F/%E9%AB%98%E5%B9%B6%E5%8F%91%E6%9E%B6%E6%9E%84(6)-%E8%B5%84%E6%BA%90%E9%9A%94%E7%A6%BB.html"
           data-tag="架构"
           data-author="" >
            <span class="post-title" title="高并发架构(六)">高并发架构(六)</span>
            <span class="post-date" title="2021-01-18 20:43:12">2021/01/18</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2021-01-18-08%E5%88%86%E5%B8%83%E5%BC%8F/%E9%AB%98%E5%B9%B6%E5%8F%91%E6%9E%B6%E6%9E%84(8)-%E6%89%A9%E5%AE%B9.html"
           data-tag="架构"
           data-author="" >
            <span class="post-title" title="高并发架构(8) 扩容">高并发架构(8) 扩容</span>
            <span class="post-date" title="2021-01-18 20:43:12">2021/01/18</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2021-01-18-08%E5%88%86%E5%B8%83%E5%BC%8F/%E9%AB%98%E5%B9%B6%E5%8F%91%E6%9E%B6%E6%9E%84(7)-%E9%99%90%E6%B5%81.html"
           data-tag="架构"
           data-author="" >
            <span class="post-title" title="高并发架构(七)">高并发架构(七)</span>
            <span class="post-date" title="2021-01-18 20:43:12">2021/01/18</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2021-01-18-08%E5%88%86%E5%B8%83%E5%BC%8F/%E9%AB%98%E5%B9%B6%E5%8F%91%E6%9E%B6%E6%9E%84(9)-%E9%99%8D%E7%BA%A7.html"
           data-tag="架构"
           data-author="" >
            <span class="post-title" title="高并发架构(9) 降级">高并发架构(9) 降级</span>
            <span class="post-date" title="2021-01-18 20:43:12">2021/01/18</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2021-01-17-08%E5%88%86%E5%B8%83%E5%BC%8F/%E9%AB%98%E5%B9%B6%E5%8F%91%E6%9E%B6%E6%9E%84(4)-%E7%BC%93%E5%AD%98.html"
           data-tag="架构"
           data-author="" >
            <span class="post-title" title="高并发架构(四)">高并发架构(四)</span>
            <span class="post-date" title="2021-01-17 20:43:12">2021/01/17</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2021-01-17-08%E5%88%86%E5%B8%83%E5%BC%8F/%E9%AB%98%E5%B9%B6%E5%8F%91%E6%9E%B6%E6%9E%84(5)-CAP%E7%90%86%E8%AE%BA.html"
           data-tag="架构"
           data-author="" >
            <span class="post-title" title="高并发架构(五)">高并发架构(五)</span>
            <span class="post-date" title="2021-01-17 20:43:12">2021/01/17</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2021-01-16-08%E5%88%86%E5%B8%83%E5%BC%8F/%E9%AB%98%E5%B9%B6%E5%8F%91%E6%9E%B6%E6%9E%84(3)-dns%E5%92%8Cnginx%E9%80%9A%E8%BF%87lua%E8%AE%BF%E9%97%AEredis.html"
           data-tag="架构"
           data-author="" >
            <span class="post-title" title="高并发架构(三)">高并发架构(三)</span>
            <span class="post-date" title="2021-01-16 20:43:12">2021/01/16</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2021-01-08-08%E5%88%86%E5%B8%83%E5%BC%8F/%E9%AB%98%E5%B9%B6%E5%8F%91%E6%9E%B6%E6%9E%84(2)-redis%E6%89%A7%E8%A1%8Clua%E5%92%8Cnginx%E6%89%A7%E8%A1%8Clua.html"
           data-tag="架构"
           data-author="" >
            <span class="post-title" title="高并发架构(二)">高并发架构(二)</span>
            <span class="post-date" title="2021-01-08 20:43:12">2021/01/08</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2021-01-07-08%E5%88%86%E5%B8%83%E5%BC%8F/%E9%AB%98%E5%B9%B6%E5%8F%91%E6%9E%B6%E6%9E%84(1)-%E9%AB%98%E5%B9%B6%E5%8F%91%E6%9E%B6%E6%9E%84%E5%92%8Clua%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80.html"
           data-tag="架构"
           data-author="" >
            <span class="post-title" title="高并发架构(一)">高并发架构(一)</span>
            <span class="post-date" title="2021-01-07 20:43:12">2021/01/07</span>
        </a>
        
        <a  class="全部文章 Spring基础 "
           href="/2020-12-25-13Spring%E5%9F%BA%E7%A1%80/springmvc.html"
           data-tag="sia"
           data-author="" >
            <span class="post-title" title="第 5-9 章 Web 中的 Spring">第 5-9 章 Web 中的 Spring</span>
            <span class="post-date" title="2020-12-25 22:13:12">2020/12/25</span>
        </a>
        
        <a  class="全部文章 Spring基础 "
           href="/2020-12-24-13Spring%E5%9F%BA%E7%A1%80/20191026sia4.html"
           data-tag="sia"
           data-author="" >
            <span class="post-title" title="第 4 章 面向切面的 Spring">第 4 章 面向切面的 Spring</span>
            <span class="post-date" title="2020-12-24 22:13:12">2020/12/24</span>
        </a>
        
        <a  class="全部文章 Spring基础 "
           href="/2020-12-23-13Spring%E5%9F%BA%E7%A1%80/20191025sia3.html"
           data-tag="sia"
           data-author="" >
            <span class="post-title" title="第 3 章 高级装配">第 3 章 高级装配</span>
            <span class="post-date" title="2020-12-23 22:13:12">2020/12/23</span>
        </a>
        
        <a  class="全部文章 其他 "
           href="/2020-12-22-README.html"
           data-tag="其他"
           data-author="" >
            <span class="post-title" title="博客汇总">博客汇总</span>
            <span class="post-date" title="2020-12-22 22:13:12">2020/12/22</span>
        </a>
        
        <a  class="全部文章 其他 "
           href="/2020-12-22-12%E5%85%B6%E4%BB%96/Linux%E5%A4%87%E5%BF%98.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Linux 常用命令备忘">Linux 常用命令备忘</span>
            <span class="post-date" title="2020-12-22 22:13:12">2020/12/22</span>
        </a>
        
        <a  class="全部文章 其他 "
           href="/2020-12-22-12%E5%85%B6%E4%BB%96/%E5%86%85%E5%AE%B9%E5%88%9B%E4%B8%9A.html"
           data-tag="随笔"
           data-author="" >
            <span class="post-title" title="内容创业">内容创业</span>
            <span class="post-date" title="2020-12-22 22:13:12">2020/12/22</span>
        </a>
        
        <a  class="全部文章 其他 "
           href="/2020-12-22-12%E5%85%B6%E4%BB%96/%E5%8D%9A%E5%AE%A2-%E9%9F%B3%E4%B9%90%E7%BB%84%E4%BB%B6%E9%9B%86%E6%88%90.html"
           data-tag="博客"
           data-author="" >
            <span class="post-title" title="Hexo 博客集成 hexo-tag-aplayer">Hexo 博客集成 hexo-tag-aplayer</span>
            <span class="post-date" title="2020-12-22 22:13:12">2020/12/22</span>
        </a>
        
        <a  class="全部文章 其他 "
           href="/2020-12-22-12%E5%85%B6%E4%BB%96/%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5.html"
           data-tag="frp,内网穿透,远程连接"
           data-author="" >
            <span class="post-title" title="使用 frp 实现远程连接和内网穿透">使用 frp 实现远程连接和内网穿透</span>
            <span class="post-date" title="2020-12-22 22:13:12">2020/12/22</span>
        </a>
        
        <a  class="全部文章 Spring基础 "
           href="/2020-12-22-13Spring%E5%9F%BA%E7%A1%80/20191022sia2.html"
           data-tag="sia"
           data-author="" >
            <span class="post-title" title="第 2 章 装配 Bean">第 2 章 装配 Bean</span>
            <span class="post-date" title="2020-12-22 22:13:12">2020/12/22</span>
        </a>
        
        <a  class="全部文章 Spring基础 "
           href="/2020-12-21-13Spring%E5%9F%BA%E7%A1%80/20191019sia1.html"
           data-tag="sia"
           data-author="" >
            <span class="post-title" title="第 1 章 构建 Spring 之旅">第 1 章 构建 Spring 之旅</span>
            <span class="post-date" title="2020-12-21 22:13:12">2020/12/21</span>
        </a>
        
        <a  class="全部文章 Java基础 "
           href="/2020-12-21-01%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89/%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89C21-%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B.html"
           data-tag="Java讲义"
           data-author="" >
            <span class="post-title" title="第 21 章 函数式编程">第 21 章 函数式编程</span>
            <span class="post-date" title="2020-12-21 22:13:12">2020/12/21</span>
        </a>
        
        <a  class="全部文章 前端 "
           href="/2020-11-30-11%E5%89%8D%E7%AB%AF/TypeScript.html"
           data-tag="TypeScript"
           data-author="" >
            <span class="post-title" title="TypeScript 学习(一)">TypeScript 学习(一)</span>
            <span class="post-date" title="2020-11-30 22:13:12">2020/11/30</span>
        </a>
        
        <a  class="全部文章 前端 "
           href="/2020-11-15-11%E5%89%8D%E7%AB%AF/Flex%E5%B8%83%E5%B1%80%E5%AE%9E%E6%88%98.html"
           data-tag="flex"
           data-author="" >
            <span class="post-title" title="Flex 布局实战">Flex 布局实战</span>
            <span class="post-date" title="2020-11-15 22:13:12">2020/11/15</span>
        </a>
        
        <a  class="全部文章 算法 "
           href="/2020-11-08-10%E7%AE%97%E6%B3%95/%E5%9F%BA%E7%A1%806-%E9%93%BE%E8%A1%A8%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98.html"
           data-tag="算法"
           data-author="" >
            <span class="post-title" title="算法基础（六）">算法基础（六）</span>
            <span class="post-date" title="2020-11-08 23:13:12">2020/11/08</span>
        </a>
        
        <a  class="全部文章 算法 "
           href="/2020-11-08-10%E7%AE%97%E6%B3%95/%E5%9F%BA%E7%A1%805-%E5%89%8D%E7%BC%80%E6%A0%91_%E6%A1%B6%E6%8E%92%E5%BA%8F_%E6%8E%92%E5%BA%8F%E6%80%BB%E7%BB%93.html"
           data-tag="算法"
           data-author="" >
            <span class="post-title" title="算法基础（五）">算法基础（五）</span>
            <span class="post-date" title="2020-11-08 22:13:12">2020/11/08</span>
        </a>
        
        <a  class="全部文章 算法 "
           href="/2020-11-02-10%E7%AE%97%E6%B3%95/%E5%9F%BA%E7%A1%803-%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%E5%92%8C%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F.html"
           data-tag="算法"
           data-author="" >
            <span class="post-title" title="算法基础（三）">算法基础（三）</span>
            <span class="post-date" title="2020-11-02 22:13:12">2020/11/02</span>
        </a>
        
        <a  class="全部文章 算法 "
           href="/2020-11-02-10%E7%AE%97%E6%B3%95/%E5%9F%BA%E7%A1%804-%E6%AF%94%E8%BE%83%E5%99%A8_%E5%A0%86%E6%8E%92%E5%BA%8F.html"
           data-tag="算法"
           data-author="" >
            <span class="post-title" title="算法基础（四）">算法基础（四）</span>
            <span class="post-date" title="2020-11-02 22:13:12">2020/11/02</span>
        </a>
        
        <a  class="全部文章 算法 "
           href="/2020-10-30-10%E7%AE%97%E6%B3%95/%E5%9F%BA%E7%A1%802.html"
           data-tag="算法"
           data-author="" >
            <span class="post-title" title="算法基础（二）">算法基础（二）</span>
            <span class="post-date" title="2020-10-30 22:13:12">2020/10/30</span>
        </a>
        
        <a  class="全部文章 算法 "
           href="/2020-10-28-10%E7%AE%97%E6%B3%95/%E5%9F%BA%E7%A1%801-%E5%A4%8D%E6%9D%82%E5%BA%A6_%E5%AF%B9%E6%95%B0%E5%99%A8_%E4%BA%8C%E5%88%86%E6%B3%95_%E5%BC%82%E6%88%96%E8%BF%90%E7%AE%97.html"
           data-tag="算法"
           data-author="" >
            <span class="post-title" title="算法基础（一）">算法基础（一）</span>
            <span class="post-date" title="2020-10-28 22:13:12">2020/10/28</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2020-10-12-08%E5%88%86%E5%B8%83%E5%BC%8F/SpringCloud(8)-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E5%AE%9E%E8%B7%B5.html"
           data-tag="Spring Cloud"
           data-author="" >
            <span class="post-title" title="Spring Cloud学习(八)">Spring Cloud学习(八)</span>
            <span class="post-date" title="2020-10-12 23:43:12">2020/10/12</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2020-10-11-08%E5%88%86%E5%B8%83%E5%BC%8F/SpringCloud(8)-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html"
           data-tag="Spring Cloud"
           data-author="" >
            <span class="post-title" title="Spring Cloud学习(八)">Spring Cloud学习(八)</span>
            <span class="post-date" title="2020-10-11 23:43:12">2020/10/11</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2020-10-10-08%E5%88%86%E5%B8%83%E5%BC%8F/SpringCloud(7)-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81.html"
           data-tag="Spring Cloud"
           data-author="" >
            <span class="post-title" title="Spring Cloud学习(七)">Spring Cloud学习(七)</span>
            <span class="post-date" title="2020-10-10 23:43:12">2020/10/10</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2020-10-04-08%E5%88%86%E5%B8%83%E5%BC%8F/SpringCloud(6)-config.html"
           data-tag="Spring Cloud"
           data-author="" >
            <span class="post-title" title="Spring Cloud学习(六)">Spring Cloud学习(六)</span>
            <span class="post-date" title="2020-10-04 23:43:12">2020/10/04</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2020-10-04-08%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D%E7%AE%A1%E7%90%86(1).html"
           data-tag="分布式会话"
           data-author="" >
            <span class="post-title" title="分布式会话管理(一)">分布式会话管理(一)</span>
            <span class="post-date" title="2020-10-04 20:43:12">2020/10/04</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2020-10-04-08%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D%E7%AE%A1%E7%90%86(3).html"
           data-tag="分布式会话"
           data-author="" >
            <span class="post-title" title="分布式会话管理(三)">分布式会话管理(三)</span>
            <span class="post-date" title="2020-10-04 20:43:12">2020/10/04</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2020-10-04-08%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D%E7%AE%A1%E7%90%86(4).html"
           data-tag="分布式会话"
           data-author="" >
            <span class="post-title" title="分布式会话管理(四)">分布式会话管理(四)</span>
            <span class="post-date" title="2020-10-04 20:43:12">2020/10/04</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2020-10-04-08%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D%E7%AE%A1%E7%90%86(2).html"
           data-tag="分布式会话"
           data-author="" >
            <span class="post-title" title="分布式会话管理(二)">分布式会话管理(二)</span>
            <span class="post-date" title="2020-10-04 20:43:12">2020/10/04</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2020-10-03-08%E5%88%86%E5%B8%83%E5%BC%8F/SpringCloud(5)-zuul.html"
           data-tag="Spring Cloud"
           data-author="" >
            <span class="post-title" title="Spring Cloud学习(五)">Spring Cloud学习(五)</span>
            <span class="post-date" title="2020-10-03 23:43:12">2020/10/03</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2020-10-03-08%E5%88%86%E5%B8%83%E5%BC%8F/SpringCloud(4)-Hystrix.html"
           data-tag="Spring Cloud"
           data-author="" >
            <span class="post-title" title="Spring Cloud学习(四)">Spring Cloud学习(四)</span>
            <span class="post-date" title="2020-10-03 23:33:12">2020/10/03</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2020-10-02-08%E5%88%86%E5%B8%83%E5%BC%8F/SpringCloud(3)-Feign.html"
           data-tag="Spring Cloud"
           data-author="" >
            <span class="post-title" title="SpringCloud学习(三)">SpringCloud学习(三)</span>
            <span class="post-date" title="2020-10-02 23:33:12">2020/10/02</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2020-10-02-08%E5%88%86%E5%B8%83%E5%BC%8F/SpringCloud(2).html"
           data-tag="Spring Cloud"
           data-author="" >
            <span class="post-title" title="Spring Cloud学习(二)">Spring Cloud学习(二)</span>
            <span class="post-date" title="2020-10-02 23:13:12">2020/10/02</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2020-10-01-08%E5%88%86%E5%B8%83%E5%BC%8F/SpringCloud(1).html"
           data-tag="Spring Cloud"
           data-author="" >
            <span class="post-title" title="Spring Cloud学习(一)">Spring Cloud学习(一)</span>
            <span class="post-date" title="2020-10-01 22:13:12">2020/10/01</span>
        </a>
        
        <a  class="全部文章 OS "
           href="/2020-09-20-04%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E7%AC%AC%E4%BA%94%E8%AF%BE.html"
           data-tag="OS"
           data-author="" >
            <span class="post-title" title="操作系统学习（五）">操作系统学习（五）</span>
            <span class="post-date" title="2020-09-20 22:13:12">2020/09/20</span>
        </a>
        
        <a  class="全部文章 OS "
           href="/2020-09-19-04%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E7%AC%AC%E5%9B%9B%E8%AF%BE.html"
           data-tag="OS"
           data-author="" >
            <span class="post-title" title="操作系统学习（四）">操作系统学习（四）</span>
            <span class="post-date" title="2020-09-19 22:13:12">2020/09/19</span>
        </a>
        
        <a  class="全部文章 OS "
           href="/2020-09-18-04%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E7%AC%AC%E4%B8%89%E8%AF%BE.html"
           data-tag="OS"
           data-author="" >
            <span class="post-title" title="操作系统学习（三）">操作系统学习（三）</span>
            <span class="post-date" title="2020-09-18 22:13:12">2020/09/18</span>
        </a>
        
        <a  class="全部文章 OS "
           href="/2020-09-16-04%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E7%AC%AC%E4%BA%8C%E8%AF%BE.html"
           data-tag="OS"
           data-author="" >
            <span class="post-title" title="操作系统学习（二）">操作系统学习（二）</span>
            <span class="post-date" title="2020-09-16 22:13:12">2020/09/16</span>
        </a>
        
        <a  class="全部文章 OS "
           href="/2020-09-15-04%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E7%AC%AC%E4%B8%80%E8%AF%BE.html"
           data-tag="OS"
           data-author="" >
            <span class="post-title" title="操作系统学习（一）">操作系统学习（一）</span>
            <span class="post-date" title="2020-09-15 22:13:12">2020/09/15</span>
        </a>
        
        <a  class="全部文章 MySQL "
           href="/2020-09-10-07MySQL/mysql_14_%E7%BB%8F%E5%85%B8%E9%9D%A2%E8%AF%95%E9%A2%98.html"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="MySql 调优(十四) 经典面试题目">MySql 调优(十四) 经典面试题目</span>
            <span class="post-date" title="2020-09-10 23:13:12">2020/09/10</span>
        </a>
        
        <a  class="全部文章 MySQL "
           href="/2020-08-29-07MySQL/mysql_13_JavaSPI%E6%9C%BA%E5%88%B6.html"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="MySql 调优(十三) Java SPI 机制详解">MySql 调优(十三) Java SPI 机制详解</span>
            <span class="post-date" title="2020-08-29 23:13:12">2020/08/29</span>
        </a>
        
        <a  class="全部文章 MySQL "
           href="/2020-08-29-07MySQL/mysql_12_%E7%BB%8F%E5%85%B8%E7%AC%94%E8%AF%95%E9%A2%98.html"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="MySql 调优(十二) 经典笔试题">MySql 调优(十二) 经典笔试题</span>
            <span class="post-date" title="2020-08-29 22:13:12">2020/08/29</span>
        </a>
        
        <a  class="全部文章 MySQL "
           href="/2020-08-29-07MySQL/mysql_11_%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB.html"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="MySql 调优(十一) 读写分离">MySql 调优(十一) 读写分离</span>
            <span class="post-date" title="2020-08-29 21:13:12">2020/08/29</span>
        </a>
        
        <a  class="全部文章 MySQL "
           href="/2020-08-29-07MySQL/mysql_10_%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6.html"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="MySql 调优(十)">MySql 调优(十)</span>
            <span class="post-date" title="2020-08-29 20:13:12">2020/08/29</span>
        </a>
        
        <a  class="全部文章 MySQL "
           href="/2020-08-27-07MySQL/mysql_9_%E4%BA%8B%E5%8A%A1.html"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="MySql 调优(九)">MySql 调优(九)</span>
            <span class="post-date" title="2020-08-27 22:13:12">2020/08/27</span>
        </a>
        
        <a  class="全部文章 MySQL "
           href="/2020-08-26-07MySQL/mysql_8_%E9%94%81%E6%9C%BA%E5%88%B6.html"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="MySql 调优(八)">MySql 调优(八)</span>
            <span class="post-date" title="2020-08-26 22:13:12">2020/08/26</span>
        </a>
        
        <a  class="全部文章 MySQL "
           href="/2020-08-16-07MySQL/mysql_7_%E7%B3%BB%E7%BB%9F%E5%8F%82%E6%95%B0%E5%92%8C%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F.html"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="MySql 调优(七)">MySql 调优(七)</span>
            <span class="post-date" title="2020-08-16 22:13:12">2020/08/16</span>
        </a>
        
        <a  class="全部文章 MySQL "
           href="/2020-08-14-07MySQL/mysql_6_%E5%88%86%E5%8C%BA.html"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="MySql 调优(六)">MySql 调优(六)</span>
            <span class="post-date" title="2020-08-14 22:13:12">2020/08/14</span>
        </a>
        
        <a  class="全部文章 MySQL "
           href="/2020-08-13-07MySQL/mysql_5_%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96.html"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="MySql 调优(五)">MySql 调优(五)</span>
            <span class="post-date" title="2020-08-13 22:13:12">2020/08/13</span>
        </a>
        
        <a  class="全部文章 MySQL "
           href="/2020-08-10-07MySQL/mysql_3_%E7%B4%A2%E5%BC%95%E5%8C%B9%E9%85%8D%E5%92%8C%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96%E7%9B%91%E6%8E%A7.html"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="MySql 调优(三)">MySql 调优(三)</span>
            <span class="post-date" title="2020-08-10 22:13:12">2020/08/10</span>
        </a>
        
        <a  class="全部文章 MySQL "
           href="/2020-08-09-07MySQL/mysql_2_%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92%E5%92%8C%E5%85%B3%E9%94%AE%E5%90%8D%E8%AF%8D.html"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="MySql 调优(二)">MySql 调优(二)</span>
            <span class="post-date" title="2020-08-09 22:13:12">2020/08/09</span>
        </a>
        
        <a  class="全部文章 MySQL "
           href="/2020-08-05-07MySQL/mysql_1_%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E5%92%8C%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E4%BC%98%E5%8C%96.html"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="MySql 调优(一)">MySql 调优(一)</span>
            <span class="post-date" title="2020-08-05 22:13:12">2020/08/05</span>
        </a>
        
        <a  class="全部文章 MySQL "
           href="/2020-08-04-07MySQL/mysql_0_%E5%AE%89%E8%A3%85%E4%B8%8E%E5%8D%B8%E8%BD%BD.html"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="MySql 安装">MySql 安装</span>
            <span class="post-date" title="2020-08-04 22:13:12">2020/08/04</span>
        </a>
        
        <a  class="全部文章 JVM "
           href="/2020-07-24-02JVM/jvm%E5%AD%A6%E4%B9%A011_jvm%E5%B8%B8%E8%A7%81%E5%8F%82%E6%95%B0%E6%80%BB%E7%BB%93.html"
           data-tag="JVM"
           data-author="" >
            <span class="post-title" title="JVM 学习（十一）">JVM 学习（十一）</span>
            <span class="post-date" title="2020-07-24 22:13:12">2020/07/24</span>
        </a>
        
        <a  class="全部文章 JVM "
           href="/2020-07-24-02JVM/jvm%E5%AD%A6%E4%B9%A012_%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%98.html"
           data-tag="JVM"
           data-author="" >
            <span class="post-title" title="JVM 学习（十二）">JVM 学习（十二）</span>
            <span class="post-date" title="2020-07-24 22:13:12">2020/07/24</span>
        </a>
        
        <a  class="全部文章 JVM "
           href="/2020-07-23-02JVM/jvm%E5%AD%A6%E4%B9%A0%2010_%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E7%AE%97%E6%B3%95.html"
           data-tag="JVM"
           data-author="" >
            <span class="post-title" title="JVM 学习（十）">JVM 学习（十）</span>
            <span class="post-date" title="2020-07-23 22:13:12">2020/07/23</span>
        </a>
        
        <a  class="全部文章 JVM "
           href="/2020-07-20-02JVM/jvm%E5%AD%A6%E4%B9%A07_xx.html"
           data-tag="JVM"
           data-author="" >
            <span class="post-title" title="JVM 学习（七）">JVM 学习（七）</span>
            <span class="post-date" title="2020-07-20 22:13:12">2020/07/20</span>
        </a>
        
        <a  class="全部文章 JVM "
           href="/2020-07-20-02JVM/jvm%E5%AD%A6%E4%B9%A08_%E8%B0%83%E4%BC%982.html"
           data-tag="JVM"
           data-author="" >
            <span class="post-title" title="JVM 学习（八）">JVM 学习（八）</span>
            <span class="post-date" title="2020-07-20 22:13:12">2020/07/20</span>
        </a>
        
        <a  class="全部文章 JVM "
           href="/2020-07-20-02JVM/jvm%E5%AD%A6%E4%B9%A09_%E8%B0%83%E4%BC%983.html"
           data-tag="JVM"
           data-author="" >
            <span class="post-title" title="JVM 学习（九）">JVM 学习（九）</span>
            <span class="post-date" title="2020-07-20 22:13:12">2020/07/20</span>
        </a>
        
        <a  class="全部文章 JVM "
           href="/2020-07-19-02JVM/jvm%E5%AD%A6%E4%B9%A06_GC.html"
           data-tag="JVM"
           data-author="" >
            <span class="post-title" title="JVM 学习（六）">JVM 学习（六）</span>
            <span class="post-date" title="2020-07-19 22:13:12">2020/07/19</span>
        </a>
        
        <a  class="全部文章 JVM "
           href="/2020-07-19-02JVM/jvm%E5%AD%A6%E4%B9%A05_%E8%BF%90%E8%A1%8C%E6%97%B6%E6%95%B0%E6%8D%AE%E5%8C%BA.html"
           data-tag="JVM"
           data-author="" >
            <span class="post-title" title="JVM 学习（五）">JVM 学习（五）</span>
            <span class="post-date" title="2020-07-19 22:13:12">2020/07/19</span>
        </a>
        
        <a  class="全部文章 JVM "
           href="/2020-07-16-02JVM/jvm%E5%AD%A6%E4%B9%A03_4_java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B.html"
           data-tag="JVM"
           data-author="" >
            <span class="post-title" title="JVM 学习（三、四）">JVM 学习（三、四）</span>
            <span class="post-date" title="2020-07-16 22:13:12">2020/07/16</span>
        </a>
        
        <a  class="全部文章 kafka "
           href="/2020-07-08-06%E9%AB%98%E5%B9%B6%E5%8F%91/kafka%E5%AD%A6%E4%B9%A02.html"
           data-tag="kafka"
           data-author="" >
            <span class="post-title" title="Kafka学习(二)">Kafka学习(二)</span>
            <span class="post-date" title="2020-07-08 22:13:12">2020/07/08</span>
        </a>
        
        <a  class="全部文章 kafka "
           href="/2020-07-08-06%E9%AB%98%E5%B9%B6%E5%8F%91/kafka%E5%AD%A6%E4%B9%A01.html"
           data-tag="kafka"
           data-author="" >
            <span class="post-title" title="Kafka学习(一)">Kafka学习(一)</span>
            <span class="post-date" title="2020-07-08 22:13:12">2020/07/08</span>
        </a>
        
        <a  class="全部文章 JVM "
           href="/2020-06-29-02JVM/jvm%E5%AD%A6%E4%B9%A02_class%E5%8A%A0%E8%BD%BD.html"
           data-tag="JVM"
           data-author="" >
            <span class="post-title" title="JVM 学习（二）">JVM 学习（二）</span>
            <span class="post-date" title="2020-06-29 22:13:12">2020/06/29</span>
        </a>
        
        <a  class="全部文章 JVM "
           href="/2020-06-28-02JVM/jvm%E5%AD%A6%E4%B9%A01_jvm%E5%9F%BA%E7%A1%80_jsf.html"
           data-tag="JVM"
           data-author="" >
            <span class="post-title" title="JVM 学习（一）">JVM 学习（一）</span>
            <span class="post-date" title="2020-06-28 22:13:12">2020/06/28</span>
        </a>
        
        <a  class="全部文章 设计模式 "
           href="/2020-06-27-09%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E4%BB%8E%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%E5%88%B0%20AOP.html"
           data-tag="Proxy"
           data-author="" >
            <span class="post-title" title="设计模式之 - 从代理模式到 Spring AOP">设计模式之 - 从代理模式到 Spring AOP</span>
            <span class="post-date" title="2020-06-27 22:13:12">2020/06/27</span>
        </a>
        
        <a  class="全部文章 IO "
           href="/2020-06-21-05IO/IO%E5%AD%A6%E4%B9%A07.html"
           data-tag="IO"
           data-author="" >
            <span class="post-title" title="IO学习（七）">IO学习（七）</span>
            <span class="post-date" title="2020-06-21 22:13:12">2020/06/21</span>
        </a>
        
        <a  class="全部文章 IO "
           href="/2020-06-21-05IO/IO%E5%AD%A6%E4%B9%A08.html"
           data-tag="IO"
           data-author="" >
            <span class="post-title" title="IO学习（八）">IO学习（八）</span>
            <span class="post-date" title="2020-06-21 22:13:12">2020/06/21</span>
        </a>
        
        <a  class="全部文章 IO "
           href="/2020-06-16-05IO/IO%E5%AD%A6%E4%B9%A05.html"
           data-tag="IO"
           data-author="" >
            <span class="post-title" title="IO学习（五）">IO学习（五）</span>
            <span class="post-date" title="2020-06-16 22:13:12">2020/06/16</span>
        </a>
        
        <a  class="全部文章 IO "
           href="/2020-06-16-05IO/IO%E5%AD%A6%E4%B9%A06.html"
           data-tag="IO"
           data-author="" >
            <span class="post-title" title="IO学习（六）">IO学习（六）</span>
            <span class="post-date" title="2020-06-16 22:13:12">2020/06/16</span>
        </a>
        
        <a  class="全部文章 IO "
           href="/2020-06-14-05IO/IO%E5%AD%A6%E4%B9%A03.html"
           data-tag="IO"
           data-author="" >
            <span class="post-title" title="IO学习（三）">IO学习（三）</span>
            <span class="post-date" title="2020-06-14 22:13:12">2020/06/14</span>
        </a>
        
        <a  class="全部文章 其他 "
           href="/2020-06-12-08%E5%88%86%E5%B8%83%E5%BC%8F/Https%E4%B9%8B%E5%AE%9E%E6%88%98.html"
           data-tag="https"
           data-author="" >
            <span class="post-title" title="Https 实战">Https 实战</span>
            <span class="post-date" title="2020-06-12 22:13:12">2020/06/12</span>
        </a>
        
        <a  class="全部文章 IO "
           href="/2020-06-10-05IO/IO%E5%AD%A6%E4%B9%A02.html"
           data-tag="IO"
           data-author="" >
            <span class="post-title" title="IO学习（二）">IO学习（二）</span>
            <span class="post-date" title="2020-06-10 22:13:12">2020/06/10</span>
        </a>
        
        <a  class="全部文章 IO "
           href="/2020-06-08-05IO/IO%E5%AD%A6%E4%B9%A01.html"
           data-tag="IO"
           data-author="" >
            <span class="post-title" title="IO学习（一）">IO学习（一）</span>
            <span class="post-date" title="2020-06-08 22:13:12">2020/06/08</span>
        </a>
        
        <a  class="全部文章 其他 "
           href="/2020-06-06-08%E5%88%86%E5%B8%83%E5%BC%8F/Https%E4%B9%8BSSLTLS%20%E5%8D%8F%E8%AE%AE.html"
           data-tag="https"
           data-author="" >
            <span class="post-title" title="Https 之 SSL/TLS 协议">Https 之 SSL/TLS 协议</span>
            <span class="post-date" title="2020-06-06 22:13:12">2020/06/06</span>
        </a>
        
        <a  class="全部文章 IO "
           href="/2020-06-06-05IO/IO%E5%AD%A6%E4%B9%A04.html"
           data-tag="IO"
           data-author="" >
            <span class="post-title" title="IO学习（四）">IO学习（四）</span>
            <span class="post-date" title="2020-06-06 22:13:12">2020/06/06</span>
        </a>
        
        <a  class="全部文章 前端 "
           href="/2020-05-25-11%E5%89%8D%E7%AB%AF/Flex%E5%B8%83%E5%B1%80.html"
           data-tag="flex"
           data-author="" >
            <span class="post-title" title="Flex 布局">Flex 布局</span>
            <span class="post-date" title="2020-05-25 22:13:12">2020/05/25</span>
        </a>
        
        <a  class="全部文章 前端 "
           href="/2020-05-25-11%E5%89%8D%E7%AB%AF/vue-todo.html"
           data-tag="vue,webpack"
           data-author="" >
            <span class="post-title" title="vue 入门项目">vue 入门项目</span>
            <span class="post-date" title="2020-05-25 22:13:12">2020/05/25</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2020-05-15-08%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BB%BB%E5%8A%A1%E7%AE%A1%E7%90%86-Saturn(2).html"
           data-tag="分布式任务"
           data-author="" >
            <span class="post-title" title="分布式任务管理-架构篇">分布式任务管理-架构篇</span>
            <span class="post-date" title="2020-05-15 20:43:12">2020/05/15</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2020-05-15-08%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BB%BB%E5%8A%A1%E7%AE%A1%E7%90%86-Saturn.html"
           data-tag="分布式任务"
           data-author="" >
            <span class="post-title" title="分布式任务管理-Saturn">分布式任务管理-Saturn</span>
            <span class="post-date" title="2020-05-15 10:43:12">2020/05/15</span>
        </a>
        
        <a  class="全部文章 MySQL "
           href="/2020-05-05-07MySQL/mycat_2.html"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="mycat">mycat</span>
            <span class="post-date" title="2020-05-05 22:13:12">2020/05/05</span>
        </a>
        
        <a  class="全部文章 其他 "
           href="/2020-05-04-12%E5%85%B6%E4%BB%96/Git%E5%A4%87%E5%BF%98.html"
           data-tag="Git"
           data-author="" >
            <span class="post-title" title="Git 常用命令备忘">Git 常用命令备忘</span>
            <span class="post-date" title="2020-05-04 22:13:12">2020/05/04</span>
        </a>
        
        <a  class="全部文章 高并发 "
           href="/2020-04-27-08%E5%88%86%E5%B8%83%E5%BC%8F/Dubbo(1)-%E5%85%A5%E9%97%A8.html"
           data-tag="Dubbo"
           data-author="" >
            <span class="post-title" title="Dubbo学习(一)">Dubbo学习(一)</span>
            <span class="post-date" title="2020-04-27 22:13:12">2020/04/27</span>
        </a>
        
        <a  class="全部文章 高并发 "
           href="/2020-04-27-08%E5%88%86%E5%B8%83%E5%BC%8F/Dubbo(2)-Rest%E5%8D%8F%E8%AE%AE.html"
           data-tag="Dubbo"
           data-author="" >
            <span class="post-title" title="Dubbo学习(二)">Dubbo学习(二)</span>
            <span class="post-date" title="2020-04-27 22:13:12">2020/04/27</span>
        </a>
        
        <a  class="全部文章 前端 "
           href="/2020-04-10-11%E5%89%8D%E7%AB%AF/uniapp.html"
           data-tag="uni-app"
           data-author="" >
            <span class="post-title" title="uni-app">uni-app</span>
            <span class="post-date" title="2020-04-10 22:13:13">2020/04/10</span>
        </a>
        
        <a  class="全部文章 前端 "
           href="/2020-04-10-11%E5%89%8D%E7%AB%AF/vue%E5%AD%A6%E4%B9%A0(2).html"
           data-tag="vue"
           data-author="" >
            <span class="post-title" title="vue 学习(二)">vue 学习(二)</span>
            <span class="post-date" title="2020-04-10 22:13:12">2020/04/10</span>
        </a>
        
        <a  class="全部文章 前端 "
           href="/2020-04-10-11%E5%89%8D%E7%AB%AF/vue%E5%AD%A6%E4%B9%A0(1).html"
           data-tag="vue"
           data-author="" >
            <span class="post-title" title="vue 学习(一)">vue 学习(一)</span>
            <span class="post-date" title="2020-04-10 22:13:12">2020/04/10</span>
        </a>
        
        <a  class="全部文章 多线程 "
           href="/2020-04-07-03%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E9%AB%98%E5%B9%B6%E5%8F%91/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%AB%98%E5%B9%B6%E5%8F%91%E5%AD%A6%E4%B9%A0(7).html"
           data-tag="多线程"
           data-author="" >
            <span class="post-title" title="多线程高并发学习(七)">多线程高并发学习(七)</span>
            <span class="post-date" title="2020-04-07 22:13:12">2020/04/07</span>
        </a>
        
        <a  class="全部文章 多线程 "
           href="/2020-04-06-03%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E9%AB%98%E5%B9%B6%E5%8F%91/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%AB%98%E5%B9%B6%E5%8F%91%E5%AD%A6%E4%B9%A0(6).html"
           data-tag="多线程"
           data-author="" >
            <span class="post-title" title="多线程高并发学习(六)">多线程高并发学习(六)</span>
            <span class="post-date" title="2020-04-06 22:13:12">2020/04/06</span>
        </a>
        
        <a  class="全部文章 多线程 "
           href="/2020-04-05-03%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E9%AB%98%E5%B9%B6%E5%8F%91/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%AB%98%E5%B9%B6%E5%8F%91%E5%AD%A6%E4%B9%A0(5).html"
           data-tag="多线程"
           data-author="" >
            <span class="post-title" title="多线程高并发学习(五)">多线程高并发学习(五)</span>
            <span class="post-date" title="2020-04-05 22:13:12">2020/04/05</span>
        </a>
        
        <a  class="全部文章 多线程 "
           href="/2020-04-04-03%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E9%AB%98%E5%B9%B6%E5%8F%91/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%AB%98%E5%B9%B6%E5%8F%91%E5%AD%A6%E4%B9%A0(4).html"
           data-tag="多线程"
           data-author="" >
            <span class="post-title" title="多线程高并发学习(四)">多线程高并发学习(四)</span>
            <span class="post-date" title="2020-04-04 22:13:12">2020/04/04</span>
        </a>
        
        <a  class="全部文章 多线程 "
           href="/2020-04-03-03%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E9%AB%98%E5%B9%B6%E5%8F%91/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%AB%98%E5%B9%B6%E5%8F%91%E5%AD%A6%E4%B9%A0(3).html"
           data-tag="多线程"
           data-author="" >
            <span class="post-title" title="多线程高并发学习(三)">多线程高并发学习(三)</span>
            <span class="post-date" title="2020-04-03 22:13:12">2020/04/03</span>
        </a>
        
        <a  class="全部文章 多线程 "
           href="/2020-04-02-03%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E9%AB%98%E5%B9%B6%E5%8F%91/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%AB%98%E5%B9%B6%E5%8F%91%E5%AD%A6%E4%B9%A0(2).html"
           data-tag="多线程"
           data-author="" >
            <span class="post-title" title="多线程高并发学习(二)">多线程高并发学习(二)</span>
            <span class="post-date" title="2020-04-02 22:13:12">2020/04/02</span>
        </a>
        
        <a  class="全部文章 多线程 "
           href="/2020-04-01-03%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E9%AB%98%E5%B9%B6%E5%8F%91/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%AB%98%E5%B9%B6%E5%8F%91%E5%AD%A6%E4%B9%A0(1).html"
           data-tag="多线程"
           data-author="" >
            <span class="post-title" title="多线程高并发学习(一)">多线程高并发学习(一)</span>
            <span class="post-date" title="2020-04-01 22:13:12">2020/04/01</span>
        </a>
        
        <a  class="全部文章 设计模式 "
           href="/2020-03-20-09%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-Observer.html"
           data-tag="Observer"
           data-author="" >
            <span class="post-title" title="设计模式之 - Observer">设计模式之 - Observer</span>
            <span class="post-date" title="2020-03-20 22:13:12">2020/03/20</span>
        </a>
        
        <a  class="全部文章 设计模式 "
           href="/2020-03-20-09%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-ResponsibilityChain.html"
           data-tag="RSC"
           data-author="" >
            <span class="post-title" title="设计模式之 - Responsibility Chain">设计模式之 - Responsibility Chain</span>
            <span class="post-date" title="2020-03-20 22:13:12">2020/03/20</span>
        </a>
        
        <a  class="全部文章 设计模式 "
           href="/2020-03-20-09%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-singleton.html"
           data-tag="Singleton"
           data-author="" >
            <span class="post-title" title="设计模式之 - Singleton">设计模式之 - Singleton</span>
            <span class="post-date" title="2020-03-20 22:13:12">2020/03/20</span>
        </a>
        
        <a  class="全部文章 高并发 "
           href="/2020-03-05-06%E9%AB%98%E5%B9%B6%E5%8F%91/zookeeper%E5%AD%A6%E4%B9%A0(%E4%B8%89).html"
           data-tag="ZooKeeper"
           data-author="" >
            <span class="post-title" title="ZooKeeper学习(三)">ZooKeeper学习(三)</span>
            <span class="post-date" title="2020-03-05 22:13:12">2020/03/05</span>
        </a>
        
        <a  class="全部文章 高并发 "
           href="/2020-03-02-06%E9%AB%98%E5%B9%B6%E5%8F%91/Redis%E5%AE%9E%E6%88%98(%E4%B8%80).html"
           data-tag="Redis"
           data-author="" >
            <span class="post-title" title="Redis实战(一)">Redis实战(一)</span>
            <span class="post-date" title="2020-03-02 22:13:12">2020/03/02</span>
        </a>
        
        <a  class="全部文章 高并发 "
           href="/2020-03-02-06%E9%AB%98%E5%B9%B6%E5%8F%91/zookeeper%E5%AD%A6%E4%B9%A0(%E4%B8%80).html"
           data-tag="ZooKeeper"
           data-author="" >
            <span class="post-title" title="ZooKeeper学习(一)">ZooKeeper学习(一)</span>
            <span class="post-date" title="2020-03-02 22:13:12">2020/03/02</span>
        </a>
        
        <a  class="全部文章 高并发 "
           href="/2020-03-02-06%E9%AB%98%E5%B9%B6%E5%8F%91/zookeeper%E5%AD%A6%E4%B9%A0(%E4%BA%8C).html"
           data-tag="ZooKeeper"
           data-author="" >
            <span class="post-title" title="ZooKeeper学习(二)">ZooKeeper学习(二)</span>
            <span class="post-date" title="2020-03-02 22:13:12">2020/03/02</span>
        </a>
        
        <a  class="全部文章 分布式 "
           href="/2020-03-02-08%E5%88%86%E5%B8%83%E5%BC%8F/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%9E%E6%88%98C3_%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86.html"
           data-tag="Eureka"
           data-author="" >
            <span class="post-title" title="第三章 服务治理">第三章 服务治理</span>
            <span class="post-date" title="2020-03-02 22:13:12">2020/03/02</span>
        </a>
        
        <a  class="全部文章 高并发 "
           href="/2020-03-01-06%E9%AB%98%E5%B9%B6%E5%8F%91/Redis%20%E5%AD%A6%E4%B9%A0(%E4%BA%94)-%E9%9D%A2%E8%AF%95%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98.html"
           data-tag="Redis"
           data-author="" >
            <span class="post-title" title="Redis 学习(五)-面试常见问题">Redis 学习(五)-面试常见问题</span>
            <span class="post-date" title="2020-03-01 22:13:12">2020/03/01</span>
        </a>
        
        <a  class="全部文章 其他 "
           href="/2020-02-28-06%E9%AB%98%E5%B9%B6%E5%8F%91/Linux%20%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E7%AE%80%E8%A6%81%E6%AD%A5%E9%AA%A4.html"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Linux 系统安装简要步骤">Linux 系统安装简要步骤</span>
            <span class="post-date" title="2020-02-28 22:13:12">2020/02/28</span>
        </a>
        
        <a  class="全部文章 其他 "
           href="/2020-02-28-06%E9%AB%98%E5%B9%B6%E5%8F%91/Typecho+Tengine%E5%BB%BA%E7%AB%99.html"
           data-tag="Nginx,Blog"
           data-author="" >
            <span class="post-title" title="Typecho+Tengine 搭建个人主页">Typecho+Tengine 搭建个人主页</span>
            <span class="post-date" title="2020-02-28 22:13:12">2020/02/28</span>
        </a>
        
        <a  class="全部文章 高并发 "
           href="/2020-02-28-06%E9%AB%98%E5%B9%B6%E5%8F%91/%E9%AB%98%E5%B9%B6%E5%8F%91%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1.html"
           data-tag="LVS,网络"
           data-author="" >
            <span class="post-title" title="高并发负载均衡">高并发负载均衡</span>
            <span class="post-date" title="2020-02-28 22:13:12">2020/02/28</span>
        </a>
        
        <a  class="全部文章 IO "
           href="/2020-02-22-05IO/IO%E5%AD%A6%E4%B9%A09.html"
           data-tag="NIO"
           data-author="" >
            <span class="post-title" title="NIO 原理">NIO 原理</span>
            <span class="post-date" title="2020-02-22 22:13:12">2020/02/22</span>
        </a>
        
        <a  class="全部文章 高并发 "
           href="/2020-02-21-06%E9%AB%98%E5%B9%B6%E5%8F%91/Redis%20%E5%AD%A6%E4%B9%A0(%E5%9B%9B)-%E9%9B%86%E7%BE%A4.html"
           data-tag="Redis"
           data-author="" >
            <span class="post-title" title="Redis 学习(四)-主从复制、高可用、集群">Redis 学习(四)-主从复制、高可用、集群</span>
            <span class="post-date" title="2020-02-21 22:13:12">2020/02/21</span>
        </a>
        
        <a  class="全部文章 高并发 "
           href="/2020-02-20-06%E9%AB%98%E5%B9%B6%E5%8F%91/Redis%20%E5%AD%A6%E4%B9%A0(%E4%B8%89)-%E6%8C%81%E4%B9%85%E5%8C%96.html"
           data-tag="Redis"
           data-author="" >
            <span class="post-title" title="Redis 学习(三)-持久化">Redis 学习(三)-持久化</span>
            <span class="post-date" title="2020-02-20 22:13:12">2020/02/20</span>
        </a>
        
        <a  class="全部文章 高并发 "
           href="/2020-02-19-06%E9%AB%98%E5%B9%B6%E5%8F%91/Redis%20%E5%AD%A6%E4%B9%A0(%E4%BA%8C)-%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD.html"
           data-tag="Redis"
           data-author="" >
            <span class="post-title" title="Redis 学习(二)-管道、发布/订阅、事务、modules、过期">Redis 学习(二)-管道、发布/订阅、事务、modules、过期</span>
            <span class="post-date" title="2020-02-19 22:13:12">2020/02/19</span>
        </a>
        
        <a  class="全部文章 高并发 "
           href="/2020-02-18-06%E9%AB%98%E5%B9%B6%E5%8F%91/Redis%20%E5%AD%A6%E4%B9%A0(%E4%B8%80)-%E5%9F%BA%E6%9C%AC%E6%8C%87%E4%BB%A4.html"
           data-tag="Redis"
           data-author="" >
            <span class="post-title" title="Redis 学习(一)-概述、安装、类型、指令">Redis 学习(一)-概述、安装、类型、指令</span>
            <span class="post-date" title="2020-02-18 22:13:12">2020/02/18</span>
        </a>
        
        <a  class="全部文章 Java基础 "
           href="/2020-01-18-01%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89/%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89C18.html"
           data-tag="Java讲义"
           data-author="" >
            <span class="post-title" title="第 18 章 类加载机制与反射">第 18 章 类加载机制与反射</span>
            <span class="post-date" title="2020-01-18 22:13:12">2020/01/18</span>
        </a>
        
        <a  class="全部文章 Java基础 "
           href="/2020-01-17-01%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89/%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89C17.html"
           data-tag="Java讲义"
           data-author="" >
            <span class="post-title" title="第 17 章 网络编程">第 17 章 网络编程</span>
            <span class="post-date" title="2020-01-17 23:13:12">2020/01/17</span>
        </a>
        
        <a  class="全部文章 Java基础 "
           href="/2020-01-16-01%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89/%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89C16.html"
           data-tag="Java讲义"
           data-author="" >
            <span class="post-title" title="第 16 章 多线程">第 16 章 多线程</span>
            <span class="post-date" title="2020-01-16 22:13:12">2020/01/16</span>
        </a>
        
        <a  class="全部文章 Java基础 "
           href="/2020-01-15-01%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89/%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89C15.html"
           data-tag="Java讲义"
           data-author="" >
            <span class="post-title" title="第 15 章 输入、输出">第 15 章 输入、输出</span>
            <span class="post-date" title="2020-01-15 22:13:12">2020/01/15</span>
        </a>
        
        <a  class="全部文章 Java基础 "
           href="/2020-01-14-01%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89/%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89C14.html"
           data-tag="Java讲义"
           data-author="" >
            <span class="post-title" title="第 14 章 注解">第 14 章 注解</span>
            <span class="post-date" title="2020-01-14 22:13:12">2020/01/14</span>
        </a>
        
        <a  class="全部文章 Java基础 "
           href="/2020-01-13-01%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89/%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89C13.html"
           data-tag="Java讲义"
           data-author="" >
            <span class="post-title" title="第 13 章 MySQL 数据库与 JDBC 编程">第 13 章 MySQL 数据库与 JDBC 编程</span>
            <span class="post-date" title="2020-01-13 22:13:12">2020/01/13</span>
        </a>
        
        <a  class="全部文章 Java基础 "
           href="/2020-01-10-01%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89/%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89C10.html"
           data-tag="Java讲义"
           data-author="" >
            <span class="post-title" title="第 10 章 异常处理">第 10 章 异常处理</span>
            <span class="post-date" title="2020-01-10 22:13:12">2020/01/10</span>
        </a>
        
        <a  class="全部文章 Java基础 "
           href="/2020-01-09-01%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89/%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89C9.html"
           data-tag="Java讲义"
           data-author="" >
            <span class="post-title" title="第 9 章 泛型">第 9 章 泛型</span>
            <span class="post-date" title="2020-01-09 22:13:12">2020/01/09</span>
        </a>
        
        <a  class="全部文章 Java基础 "
           href="/2020-01-08-01%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89/%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89C8.html"
           data-tag="Java讲义"
           data-author="" >
            <span class="post-title" title="第 8 章 Java 集合">第 8 章 Java 集合</span>
            <span class="post-date" title="2020-01-08 22:13:12">2020/01/08</span>
        </a>
        
        <a  class="全部文章 Java基础 "
           href="/2020-01-07-01%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89/%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89C7.html"
           data-tag="Java讲义"
           data-author="" >
            <span class="post-title" title="第 7 章 Java 基础类库">第 7 章 Java 基础类库</span>
            <span class="post-date" title="2020-01-07 22:13:12">2020/01/07</span>
        </a>
        
        <a  class="全部文章 Java基础 "
           href="/2020-01-06-01%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89/%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89C6.html"
           data-tag="Java讲义"
           data-author="" >
            <span class="post-title" title="第 6 章 面向对象（下）">第 6 章 面向对象（下）</span>
            <span class="post-date" title="2020-01-06 22:13:12">2020/01/06</span>
        </a>
        
        <a  class="全部文章 Java基础 "
           href="/2020-01-05-01%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89/%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89C5.html"
           data-tag="Java讲义"
           data-author="" >
            <span class="post-title" title="第 5 章 面向对象（上）">第 5 章 面向对象（上）</span>
            <span class="post-date" title="2020-01-05 22:13:12">2020/01/05</span>
        </a>
        
        <a  class="全部文章 Java基础 "
           href="/2020-01-04-01%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89/%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89C4.html"
           data-tag="Java讲义"
           data-author="" >
            <span class="post-title" title="第 4 章 流程控制与数组">第 4 章 流程控制与数组</span>
            <span class="post-date" title="2020-01-04 22:13:12">2020/01/04</span>
        </a>
        
        <a  class="全部文章 Java基础 "
           href="/2020-01-03-01%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89/%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89C3.html"
           data-tag="Java讲义"
           data-author="" >
            <span class="post-title" title="第 3 章 数据类型和运算符">第 3 章 数据类型和运算符</span>
            <span class="post-date" title="2020-01-03 22:13:12">2020/01/03</span>
        </a>
        
        <a  class="全部文章 Java基础 "
           href="/2020-01-02-01%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89/%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89C2.html"
           data-tag="Java讲义"
           data-author="" >
            <span class="post-title" title="第 2 章 理解面向对象">第 2 章 理解面向对象</span>
            <span class="post-date" title="2020-01-02 22:13:12">2020/01/02</span>
        </a>
        
        <a  class="全部文章 Java基础 "
           href="/2020-01-01-01%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89/%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89C1.html"
           data-tag="Java讲义"
           data-author="" >
            <span class="post-title" title="第 1 章 Java 语言概述与开发环境">第 1 章 Java 语言概述与开发环境</span>
            <span class="post-date" title="2020-01-01 22:13:12">2020/01/01</span>
        </a>
        
        <a  class="全部文章 Java基础 "
           href="/2020-01-01-01%E7%96%AF%E7%8B%82Java%E8%AE%B2%E4%B9%89/%E8%A1%A5%E5%85%851-HashMap.html"
           data-tag="Java讲义"
           data-author="" >
            <span class="post-title" title="HashMap 源码">HashMap 源码</span>
            <span class="post-date" title="2020-01-01 22:13:12">2020/01/01</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>
    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-06高并发/kafka学习1" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">Kafka学习(一)</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="kafka">kafka</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color1">kafka</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            发布时间 : <time class="date" title='最后更新: 2021-05-05 00:38:14'>2020-07-08 22:13</time>
        
    </div>
    <div class="article-meta">
        
        <span>字数:9.9k</span>
        
        
        <span id="busuanzi_container_page_pv">
            阅读 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="跳转至评论区">
            <a href="#comments">
                评论:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E4%BB%80%E4%B9%88%E6%98%AF-kafka%EF%BC%9F"><span class="toc-text">1. 什么是 kafka？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-Kafka-amp-MQ-%E5%9C%BA%E6%99%AF"><span class="toc-text">1.1 Kafka &amp; MQ 场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-Kafka-%E6%9E%B6%E6%9E%84%E5%88%A8%E6%9E%90"><span class="toc-text">1.2 Kafka 架构刨析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E6%A8%A1%E5%BC%8F"><span class="toc-text">常见消息队列模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Record%E3%80%81Topic%E3%80%81Broker%E3%80%81Leader-%E3%80%81-Fllower-%E5%92%8C%E5%88%86%E5%8C%BA"><span class="toc-text">Record、Topic、Broker、Leader 、 Fllower 和分区</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-kafka-%E7%89%B9%E6%80%A7"><span class="toc-text">1.3 kafka 特性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A1%BA%E5%BA%8F%E5%86%99-amp-mmap-%E9%92%88%E5%AF%B9%E7%94%9F%E4%BA%A7%E8%80%85"><span class="toc-text">顺序写&amp;mmap-针对生产者</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Zero-Copy-%E9%92%88%E5%AF%B9%E6%B6%88%E8%B4%B9%E8%80%85"><span class="toc-text">Zero Copy-针对消费者</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-AKF-%E8%A7%92%E5%BA%A6%E7%90%86%E8%A7%A3-kafka-%E6%9E%B6%E6%9E%84"><span class="toc-text">1.4 AKF 角度理解 kafka 架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-%E7%90%86%E8%A7%A3-zookeeper-%E4%BD%9C%E7%94%A8"><span class="toc-text">1.5 理解 zookeeper 作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-%E7%90%86%E8%A7%A3-producer"><span class="toc-text">1.6 理解 producer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-7-%E7%90%86%E8%A7%A3-consumer"><span class="toc-text">1.7 理解 consumer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%AE%89%E8%A3%85-amp-%E9%83%A8%E7%BD%B2"><span class="toc-text">2. 安装&amp;部署</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%8D%95%E6%9C%BA-%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-text">2.1 单机&#x2F;集群环境搭建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-kafka-%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-text">2.2 kafka 集群环境搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE"><span class="toc-text">集群配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E9%9B%86%E7%BE%A4"><span class="toc-text">使用集群</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Kafka-%E5%9F%BA%E7%A1%80-API"><span class="toc-text">3. Kafka 基础 API</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-topic-%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-text">3.1 topic 的基本操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E7%94%9F%E4%BA%A7%E8%80%85-%E6%B6%88%E8%B4%B9%E8%80%85%E4%BB%A3%E7%A0%81"><span class="toc-text">3.2 生产者&#x2F;消费者代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%88%86%E5%8C%BA%E7%AD%96%E7%95%A5"><span class="toc-text">3.4 自定义分区策略</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E5%88%86%E5%8C%BA%E7%AD%96%E7%95%A5"><span class="toc-text">默认分区策略</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%88%86%E5%8C%BA%E7%AD%96%E7%95%A5"><span class="toc-text">自定义分区策略</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E6%B6%88%E6%81%AF%E7%9A%84%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">3.3 消息的序列化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Kafka-API-%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7"><span class="toc-text">4. Kafka API 高级特性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E6%B6%88%E6%81%AF%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="toc-text">4.1 消息拦截器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-Offset-%E5%81%8F%E7%A7%BB%E9%87%8F%E6%8E%A7%E5%88%B6"><span class="toc-text">4.2 Offset 偏移量控制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-Acks-amp-Retries"><span class="toc-text">4.3 Acks &amp; Retries</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E5%B9%82%E7%AD%89%E6%80%A7"><span class="toc-text">4.3 幂等性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E4%BA%8B%E5%8A%A1%E6%8E%A7%E5%88%B6"><span class="toc-text">4.4 事务控制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%9F%E4%BA%A7%E8%80%85-only"><span class="toc-text">生产者 only</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%9F%E4%BA%A7%E8%80%85%E6%B6%88%E8%B4%B9%E8%80%85%E4%BA%8B%E5%8A%A1"><span class="toc-text">生产者消费者事务</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Kafka-%E6%9E%B6%E6%9E%84%E8%BF%9B%E9%98%B6"><span class="toc-text">5. Kafka 架构进阶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-Kafka-%E5%89%AF%E6%9C%AC%E5%90%8C%E6%AD%A5%E6%9C%BA%E5%88%B6"><span class="toc-text">5.1 Kafka 副本同步机制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E6%A6%82%E5%BF%B5%E7%90%86%E8%A7%A3"><span class="toc-text">关键概念理解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#follower-%E5%89%AF%E6%9C%AC%E6%9B%B4%E6%96%B0-LEO-%E6%97%B6%E6%9C%BA"><span class="toc-text">follower 副本更新 LEO 时机</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#follower-%E5%89%AF%E6%9C%AC%E6%9B%B4%E6%96%B0-HW-%E6%97%B6%E6%9C%BA"><span class="toc-text">follower 副本更新 HW 时机</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#leader-%E5%89%AF%E6%9C%AC%E6%9B%B4%E6%96%B0-LEO-%E6%97%B6%E6%9C%BA"><span class="toc-text">leader 副本更新 LEO 时机</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#leader-%E5%89%AF%E6%9C%AC%E6%9B%B4%E6%96%B0-HW-%E6%97%B6%E6%9C%BA"><span class="toc-text">leader 副本更新 HW 时机</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90%EF%BC%9A%E4%B8%80%E4%B8%AA-topic%EF%BC%8C%E5%8D%95%E5%88%86%E5%8C%BA%EF%BC%8C%E5%89%AF%E6%9C%AC%E5%9B%A0%E5%AD%90%E4%B8%BA-2"><span class="toc-text">例子：一个 topic，单分区，副本因子为 2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AB%98%E6%B0%B4%E4%BD%8D%E6%88%AA%E6%96%AD%E6%95%B0%E6%8D%AE%E4%B8%A2%E5%A4%B1%E9%97%AE%E9%A2%98"><span class="toc-text">高水位截断数据丢失问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AB%98%E6%B0%B4%E4%BD%8D%E6%9C%BA%E5%88%B6%E6%95%B0%E6%8D%AE%E4%B8%8D%E4%B8%80%E8%87%B4%E9%97%AE%E9%A2%98"><span class="toc-text">高水位机制数据不一致问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E9%AB%98%E6%B0%B4%E4%BD%8D%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-text">解决高水位的问题</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-Kafka-eagle-%E7%9B%91%E6%8E%A7"><span class="toc-text">5.2 Kafka eagle 监控</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E6%B5%81%E7%A8%8B"><span class="toc-text">安装流程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-Flume-%E5%92%8C-Kafka-Sink-%E9%9B%86%E6%88%90"><span class="toc-text">5.3 Flume 和 Kafka Sink 集成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-Spring-Boot-%E9%9B%86%E6%88%90-Kafka"><span class="toc-text">5.4 Spring Boot 集成 Kafka</span></a></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>kafka 关键概念理解和演示；kafka 安装和部署；kafka 监控。</p>
<a id="more"></a>

<h2 id="1-什么是-kafka？"><a href="#1-什么是-kafka？" class="headerlink" title="1. 什么是 kafka？"></a>1. 什么是 kafka？</h2><h3 id="1-1-Kafka-amp-MQ-场景"><a href="#1-1-Kafka-amp-MQ-场景" class="headerlink" title="1.1 Kafka &amp; MQ 场景"></a>1.1 Kafka &amp; MQ 场景</h3><p>Apache 软件基金会开发的一个开源<strong>流处理平台</strong>，由 Scala 和 Java 编写。是一种高吞吐量的分布式发布订阅消息系统。</p>
<p>MQ 特性：</p>
<ul>
<li>订阅、发布</li>
<li>系统间解耦</li>
<li>异步通信</li>
<li>削峰填谷</li>
</ul>
<p>功能：</p>
<ul>
<li>消息队列 Message Queue</li>
<li>Kafka Streaming 流处理（运行在应用端）</li>
</ul>
<p>例子：用户注册和发送短信。中间可以增加消息队列，用户注册成功后，注册服务器发送一个消息后直接返回成功，即让发短信业务异步处理。</p>
<p><img src="../../images/kafka/%E5%BC%82%E6%AD%A5%E9%80%9A%E4%BF%A1_%E7%B3%BB%E7%BB%9F%E8%A7%A3%E8%80%A6_%E5%89%8A%E5%B3%B0%E5%A1%AB%E8%B0%B7.png"></p>
<p><strong>问题：</strong>削峰填谷怎么实现的？大批量数据打入 mq 后，怎么实现平缓消费？背压？</p>
<p><strong>场景：</strong>一个屏幕划菜后要过一到两秒另一个屏幕才同步。原因是每次划菜后，直接把划菜日志记录数据库，然后从数据库去分发配置。分开两个服务，一个直接监听MQTT消息后直接转kafka，消费kafka数据进行落盘；另一个直接监听mqtt，然后引入Redis缓存配置。</p>
<h3 id="1-2-Kafka-架构刨析"><a href="#1-2-Kafka-架构刨析" class="headerlink" title="1.2 Kafka 架构刨析"></a>1.2 Kafka 架构刨析</h3><h4 id="常见消息队列模式"><a href="#常见消息队列模式" class="headerlink" title="常见消息队列模式"></a>常见消息队列模式</h4><ol>
<li>至多一次：消息确认被消费后，消息服务器主动删除队列中的数据</li>
<li>没有限制：消息可以被多个消费者消费。消息可以被消费多次。</li>
</ol>
<h4 id="Record、Topic、Broker、Leader-、-Fllower-和分区"><a href="#Record、Topic、Broker、Leader-、-Fllower-和分区" class="headerlink" title="Record、Topic、Broker、Leader 、 Fllower 和分区"></a>Record、Topic、Broker、Leader 、 Fllower 和分区</h4><p><strong>Record</strong>：一个 Record 属于一个 Topic</p>
<p><strong>Topic</strong>：每个 topic 都会对应<strong>一组</strong>分区。即一个 topic 可以有多个分区，不同分区的 leader 位于不同的 broker 机器。增大了吞吐量。</p>
<p><strong>Broker</strong>：Topic 的每一个日志的分区都一定会由一个 Broker 担当该分区的 Leader，其他 Broker 担当该分区的 follower。</p>
<p><strong>Leader</strong>：针对分区，指的是分区的 leader，leader 负责分区数据的<strong>读写</strong>操作。例如 分区 0，位于三个 broker，只会有一个 broker 担任分区 0 的 leader。</p>
<p><strong>Follower</strong>： 针对分区，负责同步该分区的数据。Leader 宕机，该分区的其他 Follower 会选取出新的 Leader。</p>
<p><strong>zookeeper</strong>：集群中的 Leader 的<strong>监控</strong>和 Topic <strong>部分元数据</strong>存储在 zookeeper。</p>
<p><img src="../../images/kafka/kafka%E9%9B%86%E7%BE%A4.png"></p>
<p><strong>数据分发</strong>：生产者生产指定 topic 数据后，如果 record 指定了 key，会使用 hash 函数计算后取模，决定 record 存入哪个分区。hash 函数的特征是<strong>相同的内容返回相同的 hash 值，不同的内容，尽量返回不同的 hash</strong>。使得数据均匀分散在各个分区中；相同的 key 肯定在相同的分区，因为相同的 key 进行 hash 计算肯定相同。</p>
<p><strong>副本因子</strong>：数据一共有多少份。副本因子应该小于 broker 数量，因为同一台机器存放多个副本没有什么意义。</p>
<p><strong>默认持久化时间</strong>：指定 kafka 数据过多久删除，由<code>log.retention.hours=168</code> 配置指定。默认 168 小时即 7 天。</p>
<p><strong>分区</strong>：kafka 只能保证<strong>分区内部有序</strong>，不保证分区之间的消息的顺序。也就是说同一个 topic 如果发送消息的 key 不同，则数据可能分布在不同的分区，这样即使是同一个 topic 的数据也无法保证有序。解决方案是用户自己保证相同的 topic 的消息 key 相同？这样貌似也是有问题的，有些热点 topic 数据可能极大，如果同一个 topic key 相同，这样可能会造成分区数据倾斜，这怎么办呢？</p>
<p>kafka 为什么要分区？</p>
<ul>
<li>打破单机存储的容量，实现海量数据存储</li>
<li>提升 kafka 高并发写入性能</li>
</ul>
<h3 id="1-3-kafka-特性"><a href="#1-3-kafka-特性" class="headerlink" title="1.3 kafka 特性"></a>1.3 kafka 特性</h3><h4 id="顺序写-amp-mmap-针对生产者"><a href="#顺序写-amp-mmap-针对生产者" class="headerlink" title="顺序写&amp;mmap-针对生产者"></a>顺序写&amp;mmap-针对生产者</h4><p>Kafka 的特性之一就是<strong>高吞吐量</strong>，但是 Kafka 的消息是保存或缓存在磁盘上的，一般认为在磁盘上读写数据是会降低性能的，但是 Kafka 即使是普通的服务器，Kafka 也可以轻松支持每秒百万级别的写入请求，超过了大部分的消息中间件。Kafka 会把收到的消息都写入到硬盘中，防止丢失数据，为了优化写入速度，采用了<strong>顺序写入和 MMFile</strong>。</p>
<p>应为硬盘是机械结构，每次读写都会寻址然后写入，其中寻址是一个机械动作，它是最耗时的，所以硬盘最讨厌随机 I/O，最喜欢顺序 I/O，为了提高读写硬盘的速度，Kafka 就是使用的<strong>顺序 I/O</strong>，这样省去了大量的内存开销以及节省了 I/O 寻址的时间，但是单纯的使用顺序写入，Kafka 的写入性能也不可能和内存进行对比，因此 Kafka 的数据并不是实时的写入硬盘中。</p>
<p>Kafka 充分利用了现代操作系统<strong>分页存储</strong>来利用内存，提高 I/O 效率。Memory Mapped Files（mmap）也称内存映射文件，在 64 位操作系统中一般可以表示 20G 的数据文件，它的工作原理是直接利用操作系统的 Page 实现文件到物理内存的直接映射，完成 mmap 映射后，用户对内存的所有操作会被操作系统系统的刷新到磁盘上，极大地降低了 IO 使用率。</p>
<p>kafka 写入消息时利用 mmap，直接操作内存映射区域即可，提高了 IO 效率。</p>
<blockquote>
<p>mmap操作提供了一种机制，让<a href="https://baike.baidu.com/item/%E7%94%A8%E6%88%B7%E7%A8%8B%E5%BA%8F">用户程序</a>直接访问设备内存，这种机制，相比较在<a href="https://baike.baidu.com/item/%E7%94%A8%E6%88%B7%E7%A9%BA%E9%97%B4">用户空间</a>和<a href="https://baike.baidu.com/item/%E5%86%85%E6%A0%B8%E7%A9%BA%E9%97%B4">内核空间</a>互相拷贝数据，效率更高。在要求高性能的应用中比较常用。mmap映射内存必须是页面大小的整数倍，面向流的设备不能进行mmap，mmap的实现和硬件有关。</p>
<p>mmap()系统调用使得进程之间通过映射同一个普通文件实现共享内存。普通文件被映射到进程地址空间后，进程可以像访问普通内存一样对文件进行访问，不必再调用read()，write（）等操作。</p>
<p>实际上，mmap()系统调用并不是完全为了用于共享内存而设计的。它本身提供了不同于一般对普通文件的访问方式，进程可以像读写内存一样对普通文件的操作。而Posix或System V的共享内存IPC则纯粹用于共享目的，当然mmap()实现共享内存也是其主要应用之一。</p>
</blockquote>
<p><img src="../../images/kafka/%E9%A1%BA%E5%BA%8F%E5%86%99_mmap.png"></p>
<h4 id="Zero-Copy-针对消费者"><a href="#Zero-Copy-针对消费者" class="headerlink" title="Zero Copy-针对消费者"></a>Zero Copy-针对消费者</h4><p>Kafka 服务器在响应客户端读取的时候，底层使用 Zero Copy 技术，无需将磁盘文件拷贝到用户空间，而是直接将数据通过内核空间传递输出，数据并没有抵达用户空间。</p>
<p>传统 IO 操作</p>
<ol>
<li>用户进程调用 read 等系统调用向操作系统发出 IO 请求，请求读取数据到自己的内存缓冲区中，自己进入阻塞状态。</li>
<li>操作系统收到请求后，进一步将 IO 请求发送磁盘</li>
<li>磁盘驱动器收到内核 IO 请求，把数据从磁盘读取到驱动器的缓存中，此时不占用 CPU。当驱动器的缓冲区被读满后，向内核发起<strong>中断信号</strong>，告知自己的缓冲区已满。</li>
<li>内核收到中断，使用 CPU 时间将磁盘驱动器缓存中的数据拷贝到内核缓冲区中。</li>
<li>如果内核缓冲区的数据少于用户申请读的数据，重复步骤 3 和 4，直到内核缓冲区的数据足够多为止</li>
<li>将数据从内核缓冲区拷贝到用户缓冲区，同时从系统调用中返回，完成任务</li>
</ol>
<p><img src="../../images/kafka/%E5%B8%B8%E8%A7%84io.png"></p>
<p>DMA：<strong>提升 CPU 效率</strong>，但对用户来说没有变化</p>
<p><img src="../../images/kafka/DMA.png"></p>
<p>零拷贝：<strong>将两次用户态内核态的拷贝优化为一次内核态的拷贝</strong></p>
<p><img src="../../images/kafka/%E9%9B%B6%E6%8B%B7%E8%B4%9D.png"></p>
<h3 id="1-4-AKF-角度理解-kafka-架构"><a href="#1-4-AKF-角度理解-kafka-架构" class="headerlink" title="1.4 AKF 角度理解 kafka 架构"></a>1.4 AKF 角度理解 kafka 架构</h3><ul>
<li>X轴：解决可靠性问题。副本的概念，同一个topic的分区有多个副本<ul>
<li>副本读写分离：容易出现数据同步问题，也就是主从一致性问题</li>
<li>主负责读写，从机仅当主挂了时顶替（<strong>kafka使用的方案</strong>）</li>
</ul>
</li>
<li>Y轴：按照业务拆分。topic的概念，一个topic可以理解为一个业务</li>
<li>Z轴：解决单个业务性能瓶颈。分区的概念，一个topic可以有多个分区，每个分区数据不一样<ul>
<li>带来生产和消费数据一致性问题。即如何保证消息生产的顺序和消费的顺序是一致的？</li>
<li>无关数据分区以追求并行并发；有关数据一定按照一定规则分发到同一个分区。所以kafka数据单个分区内部是有序的（每个分区为消费者维护offset），分区之间数据是无序的。</li>
</ul>
</li>
</ul>
<h3 id="1-5-理解-zookeeper-作用"><a href="#1-5-理解-zookeeper-作用" class="headerlink" title="1.5 理解 zookeeper 作用"></a>1.5 理解 zookeeper 作用</h3><ul>
<li>broker 集群 controller 的选举</li>
<li>admin-api 通过 zk 找到当前 controller</li>
</ul>
<p>zookeeper 是一个分布式协调者，不是分布式存储服务。所以分布式角色之间的通信，不要因为业务需求让zk集群成为负担。比如 kafka 中 producer 生产消息时需要拿 broker 元数据，早期 broker 元数据存在 zk 中，producer 生产消息时从 zk 去取数据，会给 zk 带来压力。现在 zk 帮 broker 集群选出 controller 后，broker 自己存储 broker 元数据，并把数据同步到各个 broker，这样在业务层次上不再依赖 zk。</p>
<p>再比如，早期 kafka 把 consumer 的 offset 信息存在 zk 中，导致每次消费数据都需要取访问 zk，增加了 zk 的压力。后边移出，并自己维护一个 topic，相当于把 offset 持久化到 kafka 内部（实际上会先到 broker 内存，然后持久化到磁盘分区），或者可以选择存储到第三方（不再推荐）。</p>
<h3 id="1-6-理解-producer"><a href="#1-6-理解-producer" class="headerlink" title="1.6 理解 producer"></a>1.6 理解 producer</h3><p>producer 可能由多个，所以消息的顺序很难保证，即使使用了分布式锁，如果使用不当也不能保证顺序性，因为分布式锁可能没有打kafka消息的推送纳入事务中。所以在并发下，一定要注意一致性问题。如果业务需要保证消息生产的顺序，一定要发送 kafka 消息后再<code>unlock</code>。</p>
<h3 id="1-7-理解-consumer"><a href="#1-7-理解-consumer" class="headerlink" title="1.7 理解 consumer"></a>1.7 理解 consumer</h3><p>思考：一个分区的数据能否被多个 consumer 消费？</p>
<p>答案：不同组之间即不同业务之间可以。但是同一个组内，<strong>绝对不行</strong>，否则没法保证分区内数据的有序性了。</p>
<p><strong>问题：</strong>按照这样设计，那么如果一个 consumer 做集群，对于数据消费这块没有性能提升？甚至还需要关掉集群中其他实例的消费服务？也就是说 kafka consumer 想做集群时该如何处理？</p>
<p>consumer 主要存在两个问题：</p>
<ul>
<li>数据丢失：offset 持久化成功了，但是业务处理失败了</li>
<li>数据重复：offset 持久化失败了，但是业务成功了</li>
</ul>
<p>offset 持久化的时机？</p>
<ul>
<li>异步的，每隔5秒持久化一次，会有重复消费问题</li>
<li>同步的，业务操作和offset持久化在一个事务</li>
<li>offset 维度：分区-consumer组-consumerID-offset</li>
</ul>
<h2 id="2-安装-amp-部署"><a href="#2-安装-amp-部署" class="headerlink" title="2. 安装&amp;部署"></a>2. 安装&amp;部署</h2><h3 id="2-1-单机-集群环境搭建"><a href="#2-1-单机-集群环境搭建" class="headerlink" title="2.1 单机/集群环境搭建"></a>2.1 单机/集群环境搭建</h3><ul>
<li>安装 JDK 1.8+，配置 JAVA_HOME</li>
<li>配置主机名和 IP 映射</li>
<li>关闭防火墙&amp;防火墙开机自启动</li>
<li>同步时钟（集群时）</li>
<li>安装&amp;启动 Zookeeper</li>
<li>安装&amp;启动|关闭 Kafka</li>
</ul>
<pre><code class="shell"># 查看 jdk 是否已经安装
rpm -qa| jdk
# 安装 jdk
rpm -ivh jdk...rpm
# 卸载
rpm -e `rpm -qa | grep jdk`
# 查看 jdk
ls /usr/
# 验证 jdk_home 是否配置成功
echo $JAVA_HOME

# 修改主机名
vim /etc/sysconfig/network
  HOSTNAME=node01
# 配置主机名和IP 映射
vim /etc/hosts
  192.168.238.66 node01
  192.168.238.68 node02
  192.168.238.70 node03
  192.168.238.72 node04
ping node01

# 关闭防火墙
service iptables status
service iptables stop
# 把防火墙服务从开机自启中删除
chkconfig iptables off
chkconfig --list

# 安装单机 zookeeper
# 见 zookeeper 教程

# 安装 kafka
cd /opt
tar -zxf /root/soft/kafka_2.12-2.3.1.tgz
vim config/server.properties
  # broker id
  broker.id=0
  # 监听端口号 node01 为主机名称
  listeners=PLAINTEXT://node01:9092
  # 日志地址
  log.dirs=/var/alvin/kafka-logs
  # zookeeper 地址
  zookeeper.connect=node01:2181

# 启动 kafka
./bin/kafka-server-start.sh -daemon config/server.properties

# 创建 topic
./bin/kafka-topics.sh --help
## 报错。Replication factor: 3 larger than available brokers: 1.
./bin/kafka-topics.sh --bootstrap-server node01:9092 --create --topic topic01 --partitions 2 --replication-factor 3
## 正常
./bin/kafka-topics.sh --bootstrap-server node01:9092 --create --topic topic01 --partitions 3 --replication-factor 1

# 创建消费者
./bin/kafka-console-consumer.sh --bootstrap-server node01:9092 --topic topic01 --group group1

# 创建生产者
./bin/kafka-console-producer.sh --broker-list node01:9092 --topic topic01

# 消费组内轮询效果（组内均分效果）。
## 再为 group1 创建两个消费者，然后生产数据发现三个消费者轮询消费
./bin/kafka-console-consumer.sh --bootstrap-server node01:9092 --topic topic01 --group group1

# 组间广播效果
## 创建一个 group2 的消费者
./bin/kafka-console-consumer.sh --bootstrap-server node01:9092 --topic topic01 --group group2</code></pre>
<h3 id="2-2-kafka-集群环境搭建"><a href="#2-2-kafka-集群环境搭建" class="headerlink" title="2.2 kafka 集群环境搭建"></a>2.2 kafka 集群环境搭建</h3><h4 id="集群配置"><a href="#集群配置" class="headerlink" title="集群配置"></a>集群配置</h4><pre><code class="shell"># 时钟同步
yun install ntp -y
ntpdate ntp[1-7].aliyun.com
clock -w

# zookeeper 集群
## 1. 配置 server
server.1=192.168.238.66:2888:3888
server.2=192.168.238.68:2888:3888
server.3=192.168.238.70:2888:3888
server.4=192.168.238.72:2888:3888
## 2. dataDir=/var/alvin/zookeeper 目录下增加 mypid 文件
echo 1 &gt; /var/alvin/zookeeper/mypid

# kafka 集群
## 1. 修改 broker id
broker.id=0
## 2. 配置 zookeeper 连接
zookeeper.connect=node01:2181,node02:2181,node03:2181</code></pre>
<h4 id="使用集群"><a href="#使用集群" class="headerlink" title="使用集群"></a>使用集群</h4><pre><code class="shell"># 创建 topic02
./bin/kafka-topics.sh --bootstrap-server node01:9092,node02:9092,node03:9092 --create --topic topic02 --partitions 3 --replication-factor 2
# 查看 topic 列表
./bin/kafka-topics.sh --bootstrap-server node01:9092,node02:9092,node03:9092 --list
# 查看 topic 详情
./bin/kafka-topics.sh --bootstrap-server node01:9092 --describe --topic topic02

# 创建 topic03
./bin/kafka-topics.sh --bootstrap-server node01:9092,node02:9092,node03:9092 --create --topic topic03 --partitions 2 --replication-factor 3
./bin/kafka-topics.sh --bootstrap-server node01:9092 --describe --topic topic03

# 修改 topic03 
## 报错，分区数只能增不能减
./bin/kafka-topics.sh --bootstrap-server node01:9092,node02:9092,node03:9092 --alter --topic topic03 --partitions 1
## 正常
./bin/kafka-topics.sh --bootstrap-server node01:9092,node02:9092,node03:9092 --alter --topic topic03 --partitions 2

# 删除 topic
./bin/kafka-topics.sh --bootstrap-server node01:9092,node02:9092,node03:9092 --delete --topic topic03

# 订阅 topic01
./bin/kafka-console-consumer.sh --bootstrap-server node01:9092,node02:9092,node03:9092 --topic topic01 --group g1 --property print.key=true --property print.value=true --property key.separator=,

# 发布
./bin/kafka-console-consumer.sh --bootstrap-server node01:9092,node02:9092,node03:9092 --topic topic01 --group g1 --property print.key=true --property print.value=true --property key.separator=,

# 消费者组
./bin/kafka-consumer-groups.sh --bootstrap-server node01:9092,node02:9092,node03:9092 --list

./bin/kafka-consumer-groups.sh --bootstrap-server node01:9092,node02:9092,node03:9092 --describe --group g1
</code></pre>
<p><img src="../../images/kafka/kafka%E9%9B%86%E7%BE%A4_me.png"></p>
<p>如果消息没有 key，则轮询。有 key 则根据 key hash。</p>
<h2 id="3-Kafka-基础-API"><a href="#3-Kafka-基础-API" class="headerlink" title="3. Kafka 基础 API"></a>3. Kafka 基础 API</h2><h3 id="3-1-topic-的基本操作"><a href="#3-1-topic-的基本操作" class="headerlink" title="3.1 topic 的基本操作"></a>3.1 topic 的基本操作</h3><p>创建、删除、列表、查看详情</p>
<pre><code class="java">public class KafkaTopicDml &#123;
    public static void main(String[] args) throws ExecutionException, InterruptedException &#123;
        // 1. 创建 KafkaAdminClient
        Properties props = new Properties();
        props.put(AdminClientConfig.BOOTSTRAP_SERVERS_CONFIG,&quot;node01:9092,node02:9092,node03:9092&quot;);
        KafkaAdminClient adminClient = (KafkaAdminClient) KafkaAdminClient.create(props);

        // 创建 Topic 信息
        CreateTopicsResult createTopicsResult = adminClient.createTopics(Arrays.asList(new NewTopic(&quot;topic03&quot;, 3, (short) 3)));
        createTopicsResult.all().get(); // 修改为同步创建

        // 删除 Topic
//        DeleteTopicsResult deleteTopicsResult = adminClient.deleteTopics(Arrays.asList(&quot;topic02&quot;, &quot;topic03&quot;));
//        deleteTopicsResult.all().get();

        // 查看 Topic 列表
        ListTopicsResult topicsResult = adminClient.listTopics();
        Set&lt;String&gt; names = topicsResult.names().get();
        for (String name : names) &#123;
            System.out.println(name);
        &#125;

        // 查看 Topic 详细信息
        DescribeTopicsResult dtr = adminClient.describeTopics(Arrays.asList(&quot;topic01&quot;));
        Map&lt;String, TopicDescription&gt; topicDescMap = dtr.all().get();
        for (Map.Entry&lt;String, TopicDescription&gt; entry : topicDescMap.entrySet()) &#123;
            System.out.println(entry.getKey() + &quot;\t&quot; + entry.getValue());
        &#125;

        // 关闭 AdminClient
        adminClient.close();
    &#125;
&#125;</code></pre>
<h3 id="3-2-生产者-消费者代码"><a href="#3-2-生产者-消费者代码" class="headerlink" title="3.2 生产者/消费者代码"></a>3.2 生产者/消费者代码</h3><p>消费者：</p>
<pre><code class="java">public class KafkaConsumerQuickStart &#123;
    public static void main(String[] args) &#123;
        // 1. 创建 KafkaConsumer
        Properties props = new Properties();
        props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG,&quot;node01:9092,node02:9092,node03:9092&quot;);
        props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName());
        props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName());
        // 消费者肯定属于一个组
        props.put(ConsumerConfig.GROUP_ID_CONFIG, &quot;g1&quot;);
        KafkaConsumer&lt;String, String&gt; consumer = new KafkaConsumer&lt;&gt;(props);

        // 2. 订阅相关的 topics
        consumer.subscribe(Pattern.compile(&quot;^topic.*&quot;));

        // 遍历消息队列
        while (true) &#123;
            ConsumerRecords&lt;String, String&gt; records = consumer.poll(Duration.ofSeconds(1));
            if (!records.isEmpty()) &#123;
                Iterator&lt;ConsumerRecord&lt;String, String&gt;&gt; iterator = records.iterator();
                while (iterator.hasNext()) &#123;
                    ConsumerRecord&lt;String, String&gt; record = iterator.next();
                    System.out.println(record.topic()+&quot;\t&quot;+record.partition()+&quot;,&quot;
                            +record.offset()+&quot;\t&quot;+record.key()+&quot; &quot;+record.value()+&quot; &quot;+record.timestamp());
                &#125;
            &#125;
        &#125;
    &#125;
&#125;</code></pre>
<p>观察日志输出：</p>
<pre><code class="shell"># 启动第一个消费者（三个分区全部分配给消费者1）
Setting newly assigned partitions: topic01-2, topic01-1, topic01-0
# 再启动一个消费者
消费者1：Setting newly assigned partitions: topic01-1, topic01-0
消费者2：Setting newly assigned partitions: topic01-2
# 再启动一个消费者
消费者1：Setting newly assigned partitions: topic01-0
消费者2：Setting newly assigned partitions: topic01-1
消费者3：Setting newly assigned partitions: topic01-2
# 再启动一个消费者，g2 组
消费者4：Setting newly assigned partitions: topic01-2, topic01-1, topic01-0</code></pre>
<p>由上可以看出，同一个组内，每次新增消费者都会<strong>重新分配分区</strong>，因为组内消息消费是均分的。组间对 topic 消费是并行的。</p>
<p>生产者：</p>
<pre><code class="java">public class KafkaProducerQuickStart &#123;
    public static void main(String[] args) &#123;
        // 1. 创建 KafkaProducer
        Properties props = new Properties();
        props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG,&quot;node01:9092,node02:9092,node03:9092&quot;);
        props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());
        props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());
        KafkaProducer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(props);

        for (int i = 0; i &lt; 10; i++) &#123;
            ProducerRecord&lt;String, String&gt; record = new ProducerRecord&lt;&gt;(&quot;topic01&quot;, &quot;key&quot; + i, &quot;value&quot; + i);
            // 发送消息
            producer.send(record);
        &#125;
        producer.close();
    &#125;
&#125;</code></pre>
<p><strong>手动指定消费分区和每个分区消费位置</strong>：</p>
<pre><code class="java">public class KafkaConsumerQuickStart_2 &#123;
    public static void main(String[] args) &#123;
        // 1. 创建 KafkaConsumer
        Properties props = new Properties();
        props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG,&quot;node01:9092,node02:9092,node03:9092&quot;);
        props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName());
        props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName());
        // 不再使用 kafka 自己的组协调机制
//        props.put(ConsumerConfig.GROUP_ID_CONFIG, &quot;g2&quot;);
        KafkaConsumer&lt;String, String&gt; consumer = new KafkaConsumer&lt;&gt;(props);

         // 2. 订阅相关的 topics，手动指定消费分区，这样将失去组管理特性
//        consumer.subscribe(Pattern.compile(&quot;^topic.*&quot;));
        List&lt;TopicPartition&gt; partitions = Arrays.asList(new TopicPartition(&quot;topic01&quot;, 0),new TopicPartition(&quot;topic01&quot;, 1));
        consumer.assign(partitions);
        // 指定消费分区的位置
        // consumer.seekToBeginning(partitions); // 从头开始消费
        consumer.seek(new TopicPartition(&quot;topic01&quot;, 0), 1); // 分区 0 从 1 开始取
        consumer.seek(new TopicPartition(&quot;topic01&quot;, 1), 2); // 分区 1 从 2 开始取

        // 遍历消息队列
        while (true) &#123;
            ConsumerRecords&lt;String, String&gt; records = consumer.poll(Duration.ofSeconds(1));
            if (!records.isEmpty()) &#123;
                Iterator&lt;ConsumerRecord&lt;String, String&gt;&gt; iterator = records.iterator();
                while (iterator.hasNext()) &#123;
                    ConsumerRecord&lt;String, String&gt; record = iterator.next();
                    System.out.println(record.topic()+&quot;\t&quot;+record.partition()+&quot;,&quot;
                            +record.offset()+&quot;\t&quot;+record.key()+&quot; &quot;+record.value()+&quot; &quot;+record.timestamp());
                &#125;
            &#125;
        &#125;
    &#125;
&#125;</code></pre>
<p>注意这样会失去 kafka 组内消费自动协调的功能，相当于每个消费者都是独立的，不会互相影响。</p>
<h3 id="3-4-自定义分区策略"><a href="#3-4-自定义分区策略" class="headerlink" title="3.4 自定义分区策略"></a>3.4 自定义分区策略</h3><h4 id="默认分区策略"><a href="#默认分区策略" class="headerlink" title="默认分区策略"></a>默认分区策略</h4><pre><code>DefaultPartitioner
* The default partitioning strategy:
* &lt;ul&gt;
* &lt;li&gt;If a partition is specified in the record, use it
* &lt;li&gt;If no partition is specified but a key is present choose a partition based on a hash of the key
* &lt;li&gt;If no partition or key is present choose a partition in a round-robin fashion</code></pre>
<h4 id="自定义分区策略"><a href="#自定义分区策略" class="headerlink" title="自定义分区策略"></a>自定义分区策略</h4><p>自定义类实现 Partitioner</p>
<pre><code class="java">public class UserDefinePartitioner implements Partitioner &#123;

    AtomicInteger counter = new AtomicInteger(0);
    /**
     * 返回分区号
     */
    @Override
    public int partition(String topic, Object key, byte[] keyBytes, Object value, byte[] valueBytes, Cluster cluster) &#123;
        // 获取所有分区
        List&lt;PartitionInfo&gt; partitions = cluster.partitionsForTopic(topic);
        int numPartitions = partitions.size();
        // 没有key，轮询
        if (keyBytes == null) &#123;
            int andIncrement = counter.getAndIncrement();
            return (andIncrement &amp; Integer.MAX_VALUE) % numPartitions;
        &#125; else &#123; // 有 key hash 分发
            return Utils.toPositive(Utils.murmur2(keyBytes)) % numPartitions;
        &#125;
    &#125;

    @Override
    public void close() &#123;
        System.out.println(&quot;close...&quot;);
    &#125;

    @Override
    public void configure(Map&lt;String, ?&gt; configs) &#123;
        System.out.println(&quot;configure...&quot;);
    &#125;
&#125;</code></pre>
<p>生产者指定分区策略</p>
<pre><code class="java">public class KafkaProducerPartitioner &#123;
    public static void main(String[] args) &#123;
        // 1. 创建 KafkaProducer
        Properties props = new Properties();
        props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG,&quot;node01:9092,node02:9092,node03:9092&quot;);
        props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());
        props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());
        // 指定自定义分区类
        props.put(ProducerConfig.PARTITIONER_CLASS_CONFIG, UserDefinePartitioner.class.getName());
        KafkaProducer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(props);

        for (int i = 0; i &lt; 30; i++) &#123;
            // 没有 key，轮询
            // ProducerRecord&lt;String, String&gt; record = new ProducerRecord&lt;&gt;(&quot;topic01&quot;, &quot;value&quot; + i);
            // 有 key，hash 分发
            ProducerRecord&lt;String, String&gt; record = new ProducerRecord&lt;&gt;(&quot;topic01&quot;, &quot;key&quot; + i, &quot;value&quot; + i);
            // 指定 partition
            // ProducerRecord&lt;String, String&gt; record = new ProducerRecord&lt;&gt;(&quot;topic01&quot;, 0, &quot;key&quot; + i, &quot;value&quot; + i);

            // 发送消息
            producer.send(record);
        &#125;
        producer.close();
    &#125;
&#125;</code></pre>
<h3 id="3-3-消息的序列化"><a href="#3-3-消息的序列化" class="headerlink" title="3.3 消息的序列化"></a>3.3 消息的序列化</h3><p>自己定义序列化器例子。</p>
<p>序列化：</p>
<pre><code class="java">public class UserDefineSerializer implements Serializer&lt;Object&gt; &#123;

    @Override
    public void configure(Map configs, boolean isKey) &#123;
        System.out.println(&quot;configure...&quot;);
    &#125;

    @Override
    public byte[] serialize(String topic, Object data) &#123;
        return SerializationUtils.serialize((Serializable) data);
    &#125;

    @Override
    public void close() &#123;
        System.out.println(&quot;close...&quot;);
    &#125;
&#125;</code></pre>
<p>反序列化：</p>
<pre><code class="java">public class UserDefineDeserializer implements Deserializer &#123;
    @Override
    public void configure(Map configs, boolean isKey) &#123;
        System.out.println(&quot;configure....&quot;);
    &#125;

    @Override
    public Object deserialize(String topic, byte[] data) &#123;
        return SerializationUtils.deserialize(data);
    &#125;

    @Override
    public void close() &#123;
        System.out.println(&quot;close....&quot;);
    &#125;
&#125;</code></pre>
<h2 id="4-Kafka-API-高级特性"><a href="#4-Kafka-API-高级特性" class="headerlink" title="4. Kafka API 高级特性"></a>4. Kafka API 高级特性</h2><h3 id="4-1-消息拦截器"><a href="#4-1-消息拦截器" class="headerlink" title="4.1 消息拦截器"></a>4.1 消息拦截器</h3><p><code>interceptor.classes</code> 配置指定拦截器。</p>
<pre><code class="java">public class UserdefineIntercepter implements ProducerInterceptor &#123;
    @Override
    public ProducerRecord onSend(ProducerRecord record) &#123;
        return new ProducerRecord(record.topic(),record.partition(),record.timestamp(),record.key(),record.value()+&quot;--alvin intr&quot;);
    &#125;

    @Override
    public void onAcknowledgement(RecordMetadata metadata, Exception exception) &#123;
        System.out.println(metadata.toString()+&quot;,&quot; + exception);
    &#125;

    @Override
    public void close() &#123;

    &#125;

    @Override
    public void configure(Map&lt;String, ?&gt; configs) &#123;

    &#125;
&#125;</code></pre>
<h3 id="4-2-Offset-偏移量控制"><a href="#4-2-Offset-偏移量控制" class="headerlink" title="4.2 Offset 偏移量控制"></a>4.2 Offset 偏移量控制</h3><p>新消费者组，初始读取位置控制：</p>
<p>auto.offset.reset=latest/earliest/none</p>
<p>Kafka 消费者在消费数据的时候默认会定期的提交消费的偏移量，告诉 broker 我消费到哪里了，这样就可以保证所有的消息至少可以被消费者消费 1 次，用户可以通过以下两个参数配置：</p>
<ul>
<li>enale.atuo.commit=true 默认</li>
<li>auto.commit.interval.ms=5000 默认</li>
</ul>
<p>自动提交间隔问题：</p>
<pre><code class="java">/**
 * @author alvin
 * @date 2020-07-05 20:13
 * 新的消费者 g7，从头开始消费。
 * 在提交 offset 之前关闭程序。
 * 再启动程序，发现还是可以消费到之前的记录
 */
public class KafkaConsumerOffest03 &#123;
    public static void main(String[] args) &#123;
        Properties prop = new Properties();
        prop.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, &quot;node01:9092,node02:9092,node03:9092&quot;);
        prop.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName());
        prop.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName());
        prop.put(ConsumerConfig.GROUP_ID_CONFIG, &quot;g7&quot;);
        // 默认 latest
        prop.put(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, &quot;earliest&quot;);
        // 十秒才提交 offset
        prop.put(ConsumerConfig.AUTO_COMMIT_INTERVAL_MS_CONFIG, 10000);
        // 允许自动提交
        prop.put(ConsumerConfig.ENABLE_AUTO_COMMIT_CONFIG, true);

        KafkaConsumer&lt;String, String&gt; consumer = new KafkaConsumer&lt;&gt;(prop);

        consumer.subscribe(Arrays.asList(&quot;topic01&quot;));

        while (true) &#123;
            ConsumerRecords&lt;String, String&gt; records = consumer.poll(Duration.ofSeconds(1));
            if (records.isEmpty()) continue;
            Iterator&lt;ConsumerRecord&lt;String, String&gt;&gt; iterator = records.iterator();
            while (iterator.hasNext()) &#123;
                ConsumerRecord&lt;String, String&gt; record = iterator.next();
                System.out.println(record.topic()+&quot;\t&quot;+record.partition()+&quot;,&quot;
                        +record.offset()+&quot;\t&quot;+record.key()+&quot; &quot;+record.value()+&quot; &quot;+record.timestamp());
            &#125;
        &#125;
    &#125;
&#125;</code></pre>
<p>手动提交：</p>
<pre><code class="java">/**
 * @author alvin
 * @date 2020-07-05 20:13
 * 关闭自动提交。
 * 手动提交 offset 必须加一，即提交的是下一次读取的 offset
 */
public class KafkaConsumerOffest04 &#123;
    public static void main(String[] args) &#123;
        Properties prop = new Properties();
        prop.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, &quot;node01:9092,node02:9092,node03:9092&quot;);
        prop.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName());
        prop.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName());
        prop.put(ConsumerConfig.GROUP_ID_CONFIG, &quot;g8&quot;);
        // 默认 latest
        prop.put(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, &quot;earliest&quot;);
        // 允许自动提交
        prop.put(ConsumerConfig.ENABLE_AUTO_COMMIT_CONFIG, false);

        KafkaConsumer&lt;String, String&gt; consumer = new KafkaConsumer&lt;&gt;(prop);

        consumer.subscribe(Arrays.asList(&quot;topic01&quot;));

        Map&lt;TopicPartition, OffsetAndMetadata&gt; offsets = new HashMap&lt;&gt;();

        while (true) &#123;
            ConsumerRecords&lt;String, String&gt; records = consumer.poll(Duration.ofSeconds(1));
            if (records.isEmpty()) continue;
            Iterator&lt;ConsumerRecord&lt;String, String&gt;&gt; iterator = records.iterator();
            while (iterator.hasNext()) &#123;
                ConsumerRecord&lt;String, String&gt; record = iterator.next();
                // 记录消费分区的偏移量元数据，这里一定要加一，不然每个分区的最后一条数据提交不上去
                offsets.put(new TopicPartition(record.topic(), record.partition()), new OffsetAndMetadata(record.offset()+1));
                // 提交消费者偏移量
                consumer.commitAsync(offsets, new OffsetCommitCallback() &#123;
                    @Override
                    public void onComplete(Map&lt;TopicPartition, OffsetAndMetadata&gt; offsets, Exception exception) &#123;
                        System.out.println(&quot;offsets:&quot; + offsets + &quot;\texception:&quot; + exception);
                    &#125;
                &#125;);
                System.out.println(record.topic()+&quot;\t&quot;+record.partition()+&quot;,&quot;
                        +record.offset()+&quot;\t&quot;+record.key()+&quot; &quot;+record.value()+&quot; &quot;+record.timestamp());
            &#125;
        &#125;
    &#125;
&#125;</code></pre>
<h3 id="4-3-Acks-amp-Retries"><a href="#4-3-Acks-amp-Retries" class="headerlink" title="4.3 Acks &amp; Retries"></a>4.3 Acks &amp; Retries</h3><ul>
<li><p>生产者发送消息要求 Broker 在规定时间（<strong>request.timeout.ms</strong>）内应答  Ack</p>
</li>
<li><p>什么时候应答可由 Ack 配置</p>
<ul>
<li>acks=1，Leader 将 Record 记录到本地日志后，不等待 Follower 的响应，立即返回。如果 Leader 确认记录后，Follower 复制记录之前宕机，则记录将丢失。</li>
<li>acks=0，生产者不会等待服务器的任何确认，自己把记录添加到套接字缓冲区中就视为已发送。这种情况下不能保证服务器已经收到记录。</li>
<li>acks=all，Leader 等所有 Follower 确认后再给生产者回复确认。这是最有力的保证。和 acks=-1 相同。</li>
</ul>
</li>
<li><p>生产者没有收到 Broker Ack 应答或应答超时，生产者可以设置重试次数（<strong>retries</strong>)。</p>
</li>
</ul>
<p>三个配置的默认值：</p>
<pre><code class="properties"># 请求超时时间，broker 在该时间内没有应答则重发
request.timeout.ms=30000
# 重发次数
retries=214748647
# 只需要 leadder 收到消息接口，不需要所有 follower 同步完成
acks=1</code></pre>
<p>注意：<strong>retries 会导致数据重复。</strong></p>
<pre><code class="java">public class KafkaProducerAcks &#123;
    public static void main(String[] args) &#123;
        Properties prop = new Properties();
        prop.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, &quot;node01:9092,node02:9092,node03:9092&quot;);
        prop.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());
        prop.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());

        // Follower 同步完成后，Leader 应答
        prop.put(ProducerConfig.ACKS_CONFIG, &quot;all&quot;);
        // 超时时间设置为 1ms（模拟肯定超时场景）
        prop.put(ProducerConfig.REQUEST_TIMEOUT_MS_CONFIG, 1);
        // 重试 3 次，不包含初始发送那次
        prop.put(ProducerConfig.RETRIES_CONFIG, 3);
        KafkaProducer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(prop);

        producer.send(new ProducerRecord&lt;String, String&gt;(&quot;topic01&quot;,&quot;ackskey&quot;, &quot;acksvalue&quot;));
        producer.flush();
        producer.close();
    &#125;
&#125;</code></pre>
<p>消费后，发现数据重复。</p>
<h3 id="4-3-幂等性"><a href="#4-3-幂等性" class="headerlink" title="4.3 幂等性"></a>4.3 幂等性</h3><p>HTTP/1.1 中对幂等性的定义：一次和多次请求某一个资源对于资源本身也应该具有同样的结果（网络超时等问题除外）。也就是说，其任意多次执行对资源本身所产生的影响均与一次执行的影响相同。</p>
<p>Methods can also have the property of “idempotence” in that(aside from error or expiration issues) the side-effects of N-&gt;0 indentical requests is the same as for a single request.</p>
<p>Kafka 在 0.11.0.0 版本增加幂等性支持。幂等是针对生产者角度的特性。保证生产者发送的消息<strong>不会丢失(retries)也不会重复</strong>。</p>
<p>实现幂等的关键就是服务端可以区分请求是否重复，过滤掉重复请求：</p>
<ul>
<li>请求中增加唯一标识，例如支付请求中，订单号就是唯一标识。</li>
<li>记录已经处理过的请求，用于和新请求的唯一标识对比，从而判断请求是否为重复请求。如果重复，则拒绝掉。</li>
</ul>
<p>幂等又称为 exactly one。在初始化期间，kafka 会给生产者生成一个唯一的 ID 称为 Producer ID 或 PID。</p>
<p>PID 和序列号与消息捆绑在一起，然后发送给 Broker。</p>
<p>序列号从零开始并且单调递增，因此，仅仅当消息的序列号比该 PID/TopicPartition 对中最后提交的消息的系列号大 1 时，Broker 才会接收该消息。如果不是这种情况，则 Broker 认定是生产者重发该消息。</p>
<p>开启幂等：enable.idempotence=true 默认为 false</p>
<p>注意：在使用幂等的时候，要求必须开启 retries=true 和 acks=all，并且 max.in.flight.requests.per.connection 小于等于 5。</p>
<p><img src="../../images/kafka/%E5%B9%82%E7%AD%89.png"></p>
<p>生产者新增配置：</p>
<pre><code class="java">// 开启幂等性，默认为 false
prop.put(ProducerConfig.ENABLE_IDEMPOTENCE_CONFIG, true);
// 一个连接发送未确认请求阻塞前的最大数量。
// 幂等性要求：必须小于等于 5，建议为 1。如果大于 1，并且设置了重发，就不能保证写入顺序了。
prop.put(ProducerConfig.MAX_IN_FLIGHT_REQUESTS_PER_CONNECTION, 1);</code></pre>
<p><strong>所以如果开启了重试又没有设置幂等，则可能导致生产者生产的数据重复。</strong></p>
<h3 id="4-4-事务控制"><a href="#4-4-事务控制" class="headerlink" title="4.4 事务控制"></a>4.4 事务控制</h3><p>Kafka 的幂等性，只能保证一条记录在<strong>分区发送的原子性</strong>，但是如果要保证多条记录（多个分区）之间的原子性，这个时候就需要开启 Kafka 的事务了。</p>
<p>Kafka 在 0.11.0.0 版本增加幂等性支持的同时也加入事务的支持。</p>
<p>Kafka 有两种事务：</p>
<ol>
<li>生产者 only 事务</li>
<li>消费者 &amp; 生产之事务</li>
</ol>
<p>消费者消费的消息的级别是 read_uncommited 数据，这有可能读取到事务失败的数据（<strong>脏读</strong>），所以在开启了生产者事务之后，需要用户设置消费者的事务隔离级别(<strong>isolation.level=read_committed</strong>)，该配置默认为 read_uncommited。</p>
<p>开启生产者事务，只需要指定 <strong>transactional.id</strong> 属性即可，一旦开启事务，默认生产者就已经开启了幂等性。transactional.id 的取值必须是唯一的，同一时刻只能有一个 transactional.id 存在，其他的将会被关闭。</p>
<h4 id="生产者-only"><a href="#生产者-only" class="headerlink" title="生产者 only"></a>生产者 only</h4><p>生产者：</p>
<ul>
<li><p>transactional.id</p>
</li>
<li><p>enable.idempotence</p>
</li>
<li><p>acks</p>
</li>
<li><p>request.timeout.ms</p>
</li>
<li><pre><code>producer.initTransactions();
producer.beginTransaction();
producer.commitTransaction();
producer.abortTransaction();</code></pre>
</li>
</ul>
<p>消费者：</p>
<ul>
<li>isolation.level</li>
</ul>
<p>生产者示例：</p>
<pre><code class="java">public class KafkaProducerTransactionProducerOnly &#123;
    public static void main(String[] args) &#123;

        KafkaProducer&lt;String, String&gt; producer = buildKafkaProducer();
        // 1. 初始化事务
        producer.initTransactions();
        try &#123;
            // 2. 开启事务
            producer.beginTransaction();
            for (int i = 0; i &lt; 5; i++) &#123;
//                if (i == 8) &#123;
//                    int j = 10/0;
//                &#125;
                ProducerRecord&lt;String, String&gt; record = new ProducerRecord&lt;&gt;(&quot;topic01&quot;, &quot;transaction&quot; + i, &quot;right data!!!&quot; + i);
                // 发送消息
                producer.send(record);
                producer.flush();
            &#125;
            // 3. 提交事务
            producer.commitTransaction();
        &#125; catch (Exception e) &#123;
            System.out.println(&quot;出现错误了~&quot; + e.getMessage());
            // 4. 终止事务
            producer.abortTransaction();
        &#125;
        producer.close();
    &#125;

    public static KafkaProducer&lt;String, String&gt; buildKafkaProducer() &#123;
        // 1. 创建 KafkaProducer
        Properties props = new Properties();
        props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG,&quot;node01:9092,node02:9092,node03:9092&quot;);
        props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());
        props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());

        // 必须配置事务 ID。必须是唯一的
        props.put(ProducerConfig.TRANSACTIONAL_ID_CONFIG, &quot;transaction-id&quot;+ UUID.randomUUID().toString());
        // 配置 Kafka 批处理大小
        props.put(ProducerConfig.BATCH_SIZE_CONFIG, 1024);
        // 如果 batch 中数据不足 1024 大小，等待 5ms
        props.put(ProducerConfig.LINGER_MS_CONFIG, 5);
        // 配置 Kafka 重试机制和幂等性
        props.put(ProducerConfig.ENABLE_IDEMPOTENCE_CONFIG, true);
        props.put(ProducerConfig.ACKS_CONFIG, &quot;all&quot;);
        props.put(ProducerConfig.REQUEST_TIMEOUT_MS_CONFIG, 20000);

        return new KafkaProducer&lt;&gt;(props);
    &#125;
&#125;</code></pre>
<p>消费者示例：</p>
<pre><code class="java">// 设置消费者的消费事务的隔离级别 read_committed
props.put(ConsumerConfig.ISOLATION_LEVEL_CONFIG, &quot;read_committed&quot;);
// props.put(ConsumerConfig.ISOLATION_LEVEL_CONFIG, &quot;read_uncommitted&quot;);</code></pre>
<h4 id="生产者消费者事务"><a href="#生产者消费者事务" class="headerlink" title="生产者消费者事务"></a>生产者消费者事务</h4><p>消费 topic01 数据发送到 topic 02。</p>
<pre><code class="java">    public static void main(String[] args) &#123;

        KafkaProducer&lt;String, String&gt; producer = buildKafkaProducer();
        KafkaConsumer&lt;String, String&gt; consumer = buildKafkaConsumer();
        // 1. 初始化事务
        producer.initTransactions();

        consumer.subscribe(Arrays.asList(&quot;topic01&quot;));
        while (true) &#123;
            ConsumerRecords&lt;String, String&gt; consumerRecords = consumer.poll(Duration.ofSeconds(1));
            if (!consumerRecords.isEmpty()) &#123;
                Map&lt;TopicPartition, OffsetAndMetadata&gt; offsets = new HashMap&lt;&gt;();
                Iterator&lt;ConsumerRecord&lt;String, String&gt;&gt; recordIterator = consumerRecords.iterator();
                // 开启事务
                producer.beginTransaction();
                try &#123;
                    // 迭代数据，进行业务处理
                    while (recordIterator.hasNext()) &#123;
                        ConsumerRecord&lt;String, String&gt; consumerRecord = recordIterator.next();
                        // 存储元数据
                        offsets.put(new TopicPartition(consumerRecord.topic(),consumerRecord.partition()),
                                new OffsetAndMetadata(consumerRecord.offset() + 1));
                        producer.send(new ProducerRecord&lt;&gt;(&quot;topic02&quot;, consumerRecord.key(),
                                consumerRecord.value() + &quot; alvin...&quot;));
                    &#125;
                    // 提交事务
                    producer.sendOffsetsToTransaction(offsets, &quot;g1&quot;); // 提交消费者的偏移量
                    producer.commitTransaction();
                &#125; catch (Exception e) &#123;
                    System.out.println(&quot;错误了~&quot;  + e.getMessage());
                    // 终止事务
                    producer.abortTransaction();
                &#125;
            &#125;
        &#125;
    &#125;</code></pre>
<p>问题：</p>
<pre><code class="java">// 必须关闭消费者端的 offset 自动提交
props.put(ConsumerConfig.ENABLE_AUTO_COMMIT_CONFIG, false); // 为啥必须关闭?</code></pre>
<h2 id="5-Kafka-架构进阶"><a href="#5-Kafka-架构进阶" class="headerlink" title="5. Kafka 架构进阶"></a>5. Kafka 架构进阶</h2><h3 id="5-1-Kafka-副本同步机制"><a href="#5-1-Kafka-副本同步机制" class="headerlink" title="5.1 Kafka 副本同步机制"></a>5.1 Kafka 副本同步机制</h3><p>Kafka 的 Topic 被分为多个分区，分区是按照 Segments 存储文件块的。分区日志是存储在磁盘上的日志序列，Kafka 可以保证分区里的事件是有序的。其中 Leader 负责对应分区的读写，Follower 负责同步分区的数据。0.11 版本之前，Kafka 使用 highwatermarker 机制保证数据的同步，但是基于 highwatermarker 的同步数据可能会导致数据的不一致或者是乱序。</p>
<h4 id="关键概念理解"><a href="#关键概念理解" class="headerlink" title="关键概念理解"></a>关键概念理解</h4><p><strong>LEO</strong>：log end offset，标识<strong>每个分区</strong>中下一个写入位置，分区的每个副本都有自己的 LEO。</p>
<p><strong>HW</strong>：high watermarker 称为高水位线。所有 HW 之前的数据都可以理解为是<strong>已经备份</strong>的，当所有节点都备份成功，Leader 会更新水位线。所有副本都有自己的 LEO 和 HW。</p>
<p><strong>ISR</strong>：In-sync-replicas，kafka 的 leader 会维护一份<strong>处于同步的副本集合</strong>，如果在 <code>replica.lag.time.max.ms</code> 时间内，系统没有发送 fetch 请求，或者已经发送请求但是在该期限内没有赶上 leader 的数据就会被剔除 ISR 列表。0.9.0 版本剔除了 <code>replica.lag.max.messages</code> 消息个数限定，因为这个会导致其他的 broker 节点频繁的加入和退出 ISR。</p>
<p><strong>Leader</strong>：Leader 副本，响应 clients 端的读写请求。</p>
<p><strong>Follower</strong>：Follower 副本，被动的备份 leader 副本中 数据，不能响应读写。</p>
<p><strong>所有的副本</strong>（leader、follower）都有 LEO 和 HW 值。</p>
<h4 id="follower-副本更新-LEO-时机"><a href="#follower-副本更新-LEO-时机" class="headerlink" title="follower 副本更新 LEO 时机"></a>follower 副本更新 LEO 时机</h4><p>Kafka 有两套 follower 副本 LEO：1. 一套 LEO 保存在 follower 副本所在的 broker 的副本管理机中；2. 另一套 LEO 保存在 leader 副本所在的 broker 的副本管理机中。<strong>即 leader 副本机器上保存了所有 follower 副本的 LEO。</strong></p>
<p>第一套帮助 follower 副本更新其 HW 值；第二套帮助 leader 副本更新其 HW 值。</p>
<ul>
<li>follower 端 follower 副本的 LEO 何时更新？</li>
</ul>
<p>follower 发送 FETCH 请求后，leader 将数据返回给 follower，此时 follower 开始向底层 log 写数据，从而自动的更新 LEO 值。</p>
<ul>
<li>leader 端 follower 副本的 LEO 何时更新？</li>
</ul>
<p>leader 端 follower 副本的 LEO 更新发生在 leader 处理 follower FETCH 请求时。一旦 leader 收到 follower 发送的 FETCH 请求，它首先会从自己的 log 中读取相应的数据，但是在给 follower 返回数据之前它先去更新 follower 的 LEO。</p>
<h4 id="follower-副本更新-HW-时机"><a href="#follower-副本更新-HW-时机" class="headerlink" title="follower 副本更新 HW 时机"></a>follower 副本更新 HW 时机</h4><p>发生在 follower 更新 LEO 之后。HW = min(follower LEO, leader HW)。由此可见 follower 的 HW 始终小于 leader 的 HW。</p>
<h4 id="leader-副本更新-LEO-时机"><a href="#leader-副本更新-LEO-时机" class="headerlink" title="leader 副本更新 LEO 时机"></a>leader 副本更新 LEO 时机</h4><p>和follower更新LEO道理相同，leader写log时就会自动地更新它自己的LEO值。</p>
<h4 id="leader-副本更新-HW-时机"><a href="#leader-副本更新-HW-时机" class="headerlink" title="leader 副本更新 HW 时机"></a>leader 副本更新 HW 时机</h4><p>这个值直接影响分区数据对于 consumer 的可见性。</p>
<ul>
<li>副本成为 leader 副本时</li>
<li>broker 出现崩溃导致副本被剔除 ISR时</li>
<li>producer 向 leader 副本写入消息时：写入消息会更新 leader 的 LEO，所以有必要再查看下 HW 值是否也需要修改</li>
<li>leader 处理 follower FETCH 请求时：先从底层的 log 读取数据，然后尝试更新分区的 HW 值。选出副本中最小的 LEO 作为 HW 值。候选副本有两个条件：<ul>
<li>处于 ISR 中</li>
<li>副本 LEO 落后于 leader LEO 的时长不大于 replica.lag.time.max.ms 参数值（默认 10 s）</li>
</ul>
</li>
</ul>
<h4 id="例子：一个-topic，单分区，副本因子为-2"><a href="#例子：一个-topic，单分区，副本因子为-2" class="headerlink" title="例子：一个 topic，单分区，副本因子为 2"></a>例子：一个 topic，单分区，副本因子为 2</h4><p><img src="../../images/kafka/hw%E5%89%AF%E6%9C%AC%E6%9C%BA%E5%88%B6.png"></p>
<ul>
<li>producer 发送一条消息 leader 端处理<ul>
<li>把消息写入底层 log（同时更新了 leader 的 LEO = 1）</li>
<li>尝试更新 leader HW。leader LEO 和 follower LEO 最小值为 0，不更新分区 HW</li>
</ul>
</li>
<li>follower 发送 fetch 请求，leader 端处理<ul>
<li>读取底层 log 数据</li>
<li>更新 follower LEO = 0（思考为什么是 0 ？）</li>
<li>尝试更新分区的 HW = min(leader LEO, follower LEO) = 0</li>
<li>把数据和当前分区 HW 值（依然是 0）发送给 follower 副本</li>
</ul>
</li>
<li>follower 收到 fetch response 后处理<ul>
<li>写入本地 log（同时更新 follower LEO = 1）</li>
<li>尝试更新 follower HW = min(follower LEO, leader HW) = 0</li>
</ul>
</li>
</ul>
<p>此时第一轮 fetch RPC 结束，发现 leader 和 follower 都已经在 log 中保存了这条消息，但是分区 HW 值还没更新</p>
<ul>
<li>follower 再次发送 fetch 请求，leader 端处理<ul>
<li>读取底层 log</li>
<li>更新 follower LEO = 1（思考这次为什么是 1 了？）</li>
<li>尝试更新分区 HW， HW = min(leader LEO, follower LEO) = 1</li>
<li>把数据（实际上没数据）和当前分区 HW 值（已更新为 1）发送给 follower 副本</li>
</ul>
</li>
<li>follower 收到 fetch response 后处理<ul>
<li>写入本地 log（这里没东西可写）</li>
<li>尝试更新 follower HW = min(follower LEO, leader HW) = 1</li>
</ul>
</li>
</ul>
<h4 id="高水位截断数据丢失问题"><a href="#高水位截断数据丢失问题" class="headerlink" title="高水位截断数据丢失问题"></a>高水位截断数据丢失问题</h4><p><img src="../../images/kafka/%E9%AB%98%E6%B0%B4%E4%BD%8D%E6%88%AA%E6%96%AD_%E6%95%B0%E6%8D%AE%E4%B8%A2%E5%A4%B1%E9%97%AE%E9%A2%98.png"></p>
<p>A 还没来得及同步 B 的水位线，A 宕机；</p>
<p>A 启动起来，截断 A 水位线之后的数据，尝试同步 leader B 数据</p>
<p>B 突然宕机，A 成为新的 leader，数据 m2 永久丢失。</p>
<h4 id="高水位机制数据不一致问题"><a href="#高水位机制数据不一致问题" class="headerlink" title="高水位机制数据不一致问题"></a>高水位机制数据不一致问题</h4><p><img src="../../images/kafka/%E9%AB%98%E6%B0%B4%E4%BD%8D%E6%9C%BA%E5%88%B6_%E6%95%B0%E6%8D%AE%E4%B8%8D%E4%B8%80%E8%87%B4%E9%97%AE%E9%A2%98.png"></p>
<h4 id="解决高水位的问题"><a href="#解决高水位的问题" class="headerlink" title="解决高水位的问题"></a>解决高水位的问题</h4><p>造成上面两个问题的根本原因在于 HW 值被用于衡量副本备份的成功与否以及在出现宕机时作为日志截断的依据，但 HW 值的更新是异步延迟的，特别是需要额外的 FETCH 请求处理流程才能更新，故中间发生的任何崩溃都可能导致 HW 值的过期。</p>
<p>kafka 0.11 之后版本引入了 leader epoch 来解决这个问题，不再使用 HW 作为数据截断的依据。</p>
<p>任意一个 leader 都持有一个 leader epoch，该 leader epoch 是一个由 controller 管理的 32 位数字，存储在 zookeeper 的分区状态信息中，并作为 leaderAndIsrRequest 的一部分传递给每个新的 leader。</p>
<p>所谓 leader epoch 实际上是一对值：（epoch, offset），epoch 表示 leader 的版本号，从 0 开始，每次 leader 变更时 epoch 加一，offset 则对应于该 epoch 版本的 leader 写入第一条消息的 offset。</p>
<pre><code class="shell">(0,0)
(1,120)
# 第一个 leader 从位移 0 开始写入消息，共写了 120 条[0,199]
# 第二个 leader 从位移 120 开始写入消息</code></pre>
<p>leader broker 中会保存这样一份缓存，这份缓存会定期地写入到一个 checkpoint 文件中。</p>
<p>每当 leader 写底层 log 时，它会尝试更新整个缓存，如果这个 leader 是首次写消息，则会在缓存中增加一个条目；否则不做更新。</p>
<p>每次副本重新成为 leader 时会查询这个缓存，获取出对应的 leader 版本的位移，这样就不会发生数据不一致和丢失的情况。</p>
<p>leader 接收 producer 请求数据后使用 leader epoch 标记每个 message，然后该 leader epoch 编号将通过复制协议传播，并用于替换 HW 标记，作为消息截断的参考点。</p>
<p><img src="../../images/kafka/leader_epoch%E6%9C%BA%E5%88%B6.png"></p>
<p>改进消息格式，以便每个消息集都带有一个 4 字节的 leader epoch 号。在每个日志目录中，会创建一个新的 leader epoch sequence 文件，在其中存储 leader epoch 的序列和在该 epoch 中生成的消息的 start offset。它也缓存在每个副本中，也缓存在内存中。</p>
<ul>
<li>follower 变成 leader</li>
</ul>
<p>先将新的 leader epoch 和副本的 LEO 添加到 leader epoch sequence 序列文件的末尾并刷新数据，给 leader 产生的每个新消息集都带有新的 leader epoch 标记。</p>
<ul>
<li>leader 变成 follower</li>
</ul>
<p>如果需要从本地的 leader epoch sequence 加载数据，将数据存储在内存中，给相应的分区的 leader 发送 epoch 请求，该请求包含最新的 epochId,startOffset 信息，leader 接收到信息以后返回该 epochId 所对应的 lastOffset 信息。该信息可能是最新 epochId 的 startoffset 或者是当前 epochId 的 LEO 信息。</p>
<p>说明：</p>
<p>解决数据丢失问题：</p>
<p><img src="../../images/kafka//epoch%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE%E4%B8%A2%E5%A4%B1%E9%97%AE%E9%A2%98.png"></p>
<p>解决数据不一致问题：</p>
<p><img src="../../images/kafka/epoche%E8%A7%A3%E5%86%B3%E6%95%B0%E6%8D%AE%E4%B8%8D%E4%B8%80%E8%87%B4%E9%97%AE%E9%A2%98.png"></p>
<h3 id="5-2-Kafka-eagle-监控"><a href="#5-2-Kafka-eagle-监控" class="headerlink" title="5.2 Kafka eagle 监控"></a>5.2 Kafka eagle 监控</h3><p>kafka eagle 是一个 kafka 监控平台。相比 kafka tools，kafka eagle 多了一个报表统计、聚合已经提醒等功能。</p>
<p>官网地址：<a href="http://download.kafka-eagle.org/">http://download.kafka-eagle.org/</a></p>
<h4 id="安装流程"><a href="#安装流程" class="headerlink" title="安装流程"></a>安装流程</h4><pre><code class="shell"># 下载软件
http://download.kafka-eagle.org/
# 安装软件
## 解压
tar -zxvf kafka-eagle-bin-2.0.0.tar.gz
## 移动到安装目录
mv kafka-eagle-bin-2.0.0 /opt/kafka-eagle
## 解压 web 包
tar -zxvf kafka-eagle-web-2.0.0-bin.tar.gz
## 配置环境变量
vim /etc/profile
  export KE_HOME=/opt/kafka-eagle
  export PATH=$PATH:$KE_HOME/bin
source /etc/profile
echo $KE_HOME

# 修改 kafka eagle 配置
vim conf/system-config.properties
  kafka.eagle.zk.cluster.alias=cluster1
  cluster1.zk.list=node01:2181,node02:2181,node03:2181
  cluster1.kafka.eagle.offset.storage=kafka
  kafka.eagle.driver=org.sqlite.JDBC
  # 这里注意 sqllite db 文件的路径
  kafka.eagle.url=jdbc:sqlite:/opt/kafka-eagle/db/ke.db
  kafka.eagle.username=root
  kafka.eagle.password=123456

# 修改 kafka 配置
cd kafka_2.12-2.3.1/
vim bin/kafka-server-start.sh
    if [ &quot;x$KAFKA_HEAP_OPTS&quot; = &quot;x&quot; ]; then
        export KAFKA_HEAP_OPTS=&quot;-Xmx1G -Xms1G&quot;
        export JMX_PORT=&quot;7788&quot;
    fi
## 重启 kafka 服务
jps
kill -9 11816
./bin/kafka-server-start.sh -daemon config/server.properties

# 启动 kafka eagle
chmod +x ke.sh
ke.sh start</code></pre>
<p>这是一个 kafka 的监控系统。感觉实现不是很难，就是连接 kafka 做一些聚合和操作，但是别人却做出来了，而自己只会找轮子，获取这就是差别吧。</p>
<h3 id="5-3-Flume-和-Kafka-Sink-集成"><a href="#5-3-Flume-和-Kafka-Sink-集成" class="headerlink" title="5.3 Flume 和 Kafka Sink 集成"></a>5.3 Flume 和 Kafka Sink 集成</h3><h3 id="5-4-Spring-Boot-集成-Kafka"><a href="#5-4-Spring-Boot-集成-Kafka" class="headerlink" title="5.4 Spring Boot 集成 Kafka"></a>5.4 Spring Boot 集成 Kafka</h3>
      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可以在下面评论区评论，也可以邮件至 lixianfu1@outlook.com </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">赏</a>
</p>




    <div id="comments"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

<script type="text/javascript">
    $.getScript('/js/gitalk.js', function () {
        var gitalk = new Gitalk({
            clientID: '8b4bf9e725fa9e5652a9',
            clientSecret: 'bfc996b7a7d84a81599a9af4ca153637bd05b9f3',
            repo: 'gitalk',
            owner: 'Monkey-kong',
            admin: ['Monkey-kong'],
            id: decodeURI(location.pathname),
            distractionFreeMode: 'true',
            language: 'zh-CN',
            perPage: parseInt('10',10)
        })
        gitalk.render('comments')
    })
</script>




    




    </div>
    <div class="copyright">
        <p class="footer-entry"><span class="miit">
                <img src="/img/gov.png" title="中华人民共和国工业和信息化部">
                <a href="http://beian.miit.gov.cn/">粤ICP备2020135752号</a>
        </span>
    
    ©2019-2020 悟空
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">×</a>
    <div class="shang_tit">
        <p>喜欢就点赞,疼爱就打赏</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="扫码支持">
            <img src="/img/weixin.jpg" class="weixin" title="扫码支持">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">支付宝</label></span><span><label><input type="radio" name="pay" value="weixin">微信</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*高亮代码块行号*/
        
        $('pre code').each(function(){
            var lines = $(this).text().trim().split('\n').length, widther='';
            if (lines>99) {
                widther = 'widther'
            }
            var $numbering = $('<ul/>').addClass('pre-numbering ' + widther).attr("unselectable","on");
            $(this).addClass('has-numbering ' + widther)
                    .parent()
                    .append($numbering);
            for(var i=1;i<=lines;i++){
                $numbering.append($('<li/>').text(i));
            }
        });
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--加入行号的高亮代码块样式-->

<style>
    pre{
        position: relative;
        margin-bottom: 24px;
        border-radius: 10px;
        border: 1px solid #e2dede;
        background: #FFF;
        overflow: hidden;
    }
    code.has-numbering{
        margin-left: 30px;
    }
    code.has-numbering.widther{
        margin-left: 35px;
    }
    .pre-numbering{
        margin: 0;
        position: absolute;
        top: 0;
        left: 0;
        width: 20px;
        padding: 0.5em 3px 0.7em 5px;
        border-right: 1px solid #C3CCD0;
        text-align: right;
        color: #AAA;
        background-color: ;
    }
    .pre-numbering.widther {
        width: 35px;
    }
</style>

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 562px;
    }
    .nav.fullscreen {
        margin-left: -562px;
    }
    .nav-left {
        width: 140px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
</style>






</html>
